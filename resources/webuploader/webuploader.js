var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||typeof Object.defineProperties=='function'?Object.defineProperty:function(b,c,a){a=a;if(b==Array.prototype||b==Object.prototype){return}b[c]=a.value};$jscomp.getGlobal=function(a){return typeof window!='undefined'&&window===a?a:typeof global!='undefined'&&global!=null?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(i,f,j,k){if(!f){return}var a=$jscomp.global;var b=i.split('.');for(var e=0;e<b.length-1;e++){var d=b[e];if(!(d in a)){a[d]={}}a=a[d]}var g=b[b.length-1];var h=a[g];var c=f(h);if(c==h||c==null){return}$jscomp.defineProperty(a,g,{configurable:!0,writable:!0,value:c})};$jscomp.polyfill('Array.prototype.copyWithin',function(a){if(a){return a}var b=function(d,c,b){var e=this.length;d=Number(d);c=Number(c);b=Number(b!=null?b:e);if(d<c){b=Math.min(b,e);while(c<b){if(c in this){this[d++]=this[c++]}else {delete this[d++];c++}}}else {b=Math.min(b,e+c-d);d+=b-c;while(b>c){if(--b in this){this[--d]=this[b]}else {delete this[d]}}}return this};return b},'es6','es3');$jscomp.SYMBOL_PREFIX='jscomp_symbol_';$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global['Symbol']){$jscomp.global['Symbol']=$jscomp.Symbol}};$jscomp.Symbol=function(){var a=0;function Symbol(b){return $jscomp.SYMBOL_PREFIX+(b||'')+a++}return Symbol}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global['Symbol'].iterator;if(!a){a=$jscomp.global['Symbol'].iterator=$jscomp.global['Symbol']('iterator')}if(typeof Array.prototype[a]!='function'){$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}})}$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){if(b<a.length){return {done:!1,value:a[b++]}}else {return {done:!0}}})};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();var a={next:b};a[$jscomp.global['Symbol'].iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();if(a instanceof String){a=a+''}var c=0;var b={next:function(){if(c<a.length){var e=c++;return {value:d(e,a[e]),done:!1}}b.next=function(){return {done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};$jscomp.polyfill('Array.prototype.entries',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(b,c){return [b,c]})};return b},'es6','es3');$jscomp.polyfill('Array.prototype.fill',function(a){if(a){return a}var b=function(f,c,b){var d=this.length||0;if(c<0){c=Math.max(0,d+c)}if(b==null||b>d){b=d}b=Number(b);if(b<0){b=Math.max(0,d+b)}for(var e=Number(c||0);e<b;e++){this[e]=f}return this};return b},'es6','es3');$jscomp.findInternal=function(a,d,e){if(a instanceof String){a=String(a)}var f=a.length;for(var b=0;b<f;b++){var c=a[b];if(d.call(e,c,b,a)){return {i:b,v:c}}}return {i:-1,v:void 0}};$jscomp.polyfill('Array.prototype.find',function(a){if(a){return a}var b=function(c,b){return $jscomp.findInternal(this,c,b).v};return b},'es6','es3');$jscomp.polyfill('Array.prototype.findIndex',function(a){if(a){return a}var b=function(c,b){return $jscomp.findInternal(this,c,b).i};return b},'es6','es3');$jscomp.polyfill('Array.from',function(a){if(a){return a}var b=function(b,c,g){$jscomp.initSymbolIterator();c=c!=null?c:function(d){return d};var e=[];var f=b[Symbol.iterator];if(typeof f=='function'){b=f.call(b);var h;var j=0;while(!(h=b.next()).done){e.push(c.call(g,h.value,j++))}}else {var i=b.length;for(var d=0;d<i;d++){e.push(c.call(g,b[d],d))}}return e};return b},'es6','es3');$jscomp.polyfill('Object.is',function(a){if(a){return a}var b=function(b,c){if(b===c){return b!==0||1/b===1/c}else {return b!==b&&c!==c}};return b},'es6','es3');$jscomp.polyfill('Array.prototype.includes',function(a){if(a){return a}var b=function(d,g){var c=this;if(c instanceof String){c=String(c)}var f=c.length;var b=g||0;if(b<0){b=Math.max(b+f,0)}for(;b<f;b++){var e=c[b];if(e===d||Object.is(e,d)){return !0}}return !1};return b},'es7','es3');$jscomp.polyfill('Array.prototype.keys',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(b){return b})};return b},'es6','es3');$jscomp.polyfill('Array.of',function(a){if(a){return a}var b=function(b){return Array.from(arguments)};return b},'es6','es3');$jscomp.polyfill('Array.prototype.values',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(c,b){return b})};return b},'es8','es3');$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.polyfill('Promise',function(c){if(c&&!$jscomp.FORCE_POLYFILL_PROMISE){return c}function AsyncExecutor(){this.batch_=null}AsyncExecutor.prototype.asyncExecute=function(a){if(this.batch_==null){this.batch_=[];this.asyncExecuteBatch_()}this.batch_.push(a);return this};AsyncExecutor.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var e=$jscomp.global['setTimeout'];AsyncExecutor.prototype.asyncExecuteFunction=function(a){e(a,0)};AsyncExecutor.prototype.executeBatch_=function(){while(this.batch_&&this.batch_.length){var b=this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var d=b[a];b[a]=null;try{d()}catch(f){this.asyncThrow_(f)}}}this.batch_=null};AsyncExecutor.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a})};var b={PENDING:0,FULFILLED:1,REJECTED:2};var a=function(d){this.state_=b.PENDING;this.result_=undefined;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{d(a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.createResolveAndReject_=function(){var b=this;var a=!1;function firstCallWins(d){return function(e){if(!a){a=!0;d.call(b,e)}}}return {resolve:firstCallWins(this.resolveTo_),reject:firstCallWins(this.reject_)}};a.prototype.resolveTo_=function(b){if(b===this){this.reject_(new TypeError('A Promise cannot resolve to itself'))}else {if(b instanceof a){this.settleSameAsPromise_(b)}else {if(isObject(b)){this.resolveToNonPromiseObj_(b)}else {this.fulfill_(b)}}}};a.prototype.resolveToNonPromiseObj_=function(b){var a=undefined;try{a=b.then}catch(f){this.reject_(f);return}if(typeof a=='function'){this.settleSameAsThenable_(a,b)}else {this.fulfill_(b)}};function isObject(a){switch(typeof a){case 'object':return a!=null;case 'function':return !0;default:return !1;}}a.prototype.reject_=function(a){this.settle_(b.REJECTED,a)};a.prototype.fulfill_=function(a){this.settle_(b.FULFILLED,a)};a.prototype.settle_=function(d,a){if(this.state_!=b.PENDING){throw new Error('Cannot settle('+d+', '+a+'): Promise already settled in state'+this.state_)}this.state_=d;this.result_=a;this.executeOnSettledCallbacks_()};a.prototype.executeOnSettledCallbacks_=function(){if(this.onSettledCallbacks_!=null){for(var a=0;a<this.onSettledCallbacks_.length;++a){d.asyncExecute(this.onSettledCallbacks_[a])}this.onSettledCallbacks_=null}};var d=new AsyncExecutor();a.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};a.prototype.settleSameAsThenable_=function(b,d){var a=this.createResolveAndReject_();try{b.call(d,a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.then=function(f,g){var b;var d;var e=new a(function(a,e){b=a;d=e});function createCallback(a,e){if(typeof a=='function'){return function(h){try{b(a(h))}catch(i){d(i)}}}else {return e}}this.callWhenSettled_(createCallback(f,b),createCallback(g,d));return e};a.prototype['catch']=function(a){return this.then(undefined,a)};a.prototype.callWhenSettled_=function(e,f){var a=this;function callback(){switch(a.state_){case b.FULFILLED:e(a.result_);break;case b.REJECTED:f(a.result_);break;default:throw new Error('Unexpected state: '+a.state_);}}if(this.onSettledCallbacks_==null){d.asyncExecute(callback)}else {this.onSettledCallbacks_.push(callback)}};function resolvingPromise(b){if(b instanceof a){return b}else {return new a(function(a,d){a(b)})}}a['resolve']=resolvingPromise;a['reject']=function(b){return new a(function(d,a){a(b)})};a['race']=function(b){return new a(function(e,f){var d=$jscomp.makeIterator(b);for(var a=d.next();!a.done;a=d.next()){resolvingPromise(a.value).callWhenSettled_(e,f)}})};a['all']=function(e){var d=$jscomp.makeIterator(e);var b=d.next();if(b.done){return resolvingPromise([])}else {return new a(function(g,h){var a=[];var f=0;function onFulfilled(b){return function(d){a[b]=d;f--;if(f==0){g(a)}}}do{a.push(undefined);f++;resolvingPromise(b.value).callWhenSettled_(onFulfilled(a.length-1),h);b=d.next()}while(!b.done)})}};return a},'es6','es3');$jscomp.polyfill('Promise.prototype.finally',function(a){if(a){return a}var b=function(b){return this.then(function(d){var c=Promise.resolve(b());return c.then(function(){return d})},function(d){var c=Promise.resolve(b());return c.then(function(){throw d})})};return b},'es9','es3');$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0};var a={};try{a.__proto__=b;return a.a}catch(c){}return !1};$jscomp.setPrototypeOf=typeof Object.setPrototypeOf=='function'?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b){throw new TypeError(a+' is not extensible')}return a}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(a instanceof Object){return}throw new TypeError('Iterator result '+a+' is not an object')};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=undefined;this.nextAddress=1;this.catchAddress_=0;this.finallyAddress_=0;this.abruptCompletion_=null;this.finallyContexts_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_){throw new TypeError('Generator is already running')}this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype['return']=function(a){this.abruptCompletion_={'return':a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(b,a){this.nextAddress=a;return {value:b}};$jscomp.generator.Context.prototype.yieldAll=function(d,b){var c=$jscomp.makeIterator(d);var a=c.next();$jscomp.generator.ensureIteratorResultIsObject_(a);if(a.done){this.yieldResult=a.value;this.nextAddress=b;return}this.yieldAllIterator_=c;return this.yield(a.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(b,a){this.catchAddress_=b;if(a!=undefined){this.finallyAddress_=a}};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(b,a){this.nextAddress=b;this.catchAddress_=a||0};$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;var b=this.abruptCompletion_.exception;this.abruptCompletion_=null;return b};$jscomp.generator.Context.prototype.enterFinallyBlock=function(c,b,a){if(!a){this.finallyContexts_=[this.abruptCompletion_]}else {this.finallyContexts_[a]=this.abruptCompletion_}this.catchAddress_=c||0;this.finallyAddress_=b||0};$jscomp.generator.Context.prototype.leaveFinallyBlock=function(d,c){var b=this.finallyContexts_.splice(c||0)[0];var a=this.abruptCompletion_=this.abruptCompletion_||b;if(a){if(a.isException){return this.jumpToErrorHandler_()}if(a.jumpTo!=undefined&&this.finallyAddress_<a.jumpTo){this.nextAddress=a.jumpTo;this.abruptCompletion_=null}else {this.nextAddress=this.finallyAddress_}}else {this.nextAddress=d}};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a){this.properties_.push(b)}this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){while(this.properties_.length>0){var a=this.properties_.pop();if(a in this.object_){return a}}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context();this.program_=a};$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_){return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_)}this.context_.next_(a);return this.nextStep_()};$jscomp.generator.Engine_.prototype.return_=function(b){this.context_.start_();var a=this.context_.yieldAllIterator_;if(a){var c='return' in a?a['return']:function(a){return {value:a,done:!0}};return this.yieldAllStep_(c,b,this.context_['return'])}this.context_['return'](b);return this.nextStep_()};$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_){return this.yieldAllStep_(this.context_.yieldAllIterator_['throw'],a,this.context_.next_)}this.context_.throw_(a);return this.nextStep_()};$jscomp.generator.Engine_.prototype.yieldAllStep_=function(d,e,c){try{var a=d.call(this.context_.yieldAllIterator_,e);$jscomp.generator.ensureIteratorResultIsObject_(a);if(!a.done){this.context_.stop_();return a}var b=a.value}catch(f){this.context_.yieldAllIterator_=null;this.context_.throw_(f);return this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,b);return this.nextStep_()};$jscomp.generator.Engine_.prototype.nextStep_=function(){while(this.context_.nextAddress){try{var b=this.program_(this.context_);if(b){this.context_.stop_();return {value:b.value,done:!1}}}catch(c){this.context_.yieldResult=undefined;this.context_.throw_(c)}}this.context_.stop_();if(this.context_.abruptCompletion_){var a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException){throw a.exception}return {value:a['return'],done:!0}}return {value:undefined,done:!0}};$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this['throw']=function(b){return a.throw_(b)};this['return']=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(b,c){var a=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(c));if($jscomp.setPrototypeOf){$jscomp.setPrototypeOf(a,b.prototype)}return a};$jscomp.asyncExecutePromiseGenerator=function(a){function passValueToGenerator(b){return a.next(b)}function passErrorToGenerator(b){return a['throw'](b)}return new Promise(function(b,c){function handleGeneratorRecord(d){if(d.done){b(d.value)}else {Promise.resolve(d.value).then(passValueToGenerator,passErrorToGenerator).then(handleGeneratorRecord,c)}}handleGeneratorRecord(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={};var b=Object.create(new $jscomp.global['Proxy'](a,{'get':function(d,e,c){return d==a&&e=='q'&&c==b}}));return b['q']===!0}catch(c){return !1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};$jscomp.polyfill('WeakMap',function(c){function isConformant(){if(!c||!Object.seal){return !1}try{var b=Object.seal({});var d=Object.seal({});var a=new c([[b,2],[d,3]]);if(a.get(b)!=2||a.get(d)!=3){return !1}a['delete'](b);a.set(d,4);return !a.has(b)&&a.get(d)==4}catch(e){return !1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE){return c}}else {if(isConformant()){return c}}var a='$jscomp_hidden_'+Math.random();function insert(b){if(!$jscomp.owns(b,a)){var d={};$jscomp.defineProperty(b,a,{value:d})}}function patch(a){var b=Object[a];if(b){Object[a]=function(d){insert(d);return b(d)}}}patch('freeze');patch('preventExtensions');patch('seal');var d=0;var b=function(a){this.id_=(d+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=$jscomp.makeIterator(a);var b;while(!(b=f.next()).done){var e=b.value;this.set(e[0],e[1])}}};b.prototype.set=function(b,d){insert(b);if(!$jscomp.owns(b,a)){throw new Error('WeakMap key fail: '+b)}b[a][this.id_]=d;return this};b.prototype.get=function(b){return $jscomp.owns(b,a)?b[a][this.id_]:undefined};b.prototype.has=function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)};b.prototype['delete']=function(b){if(!$jscomp.owns(b,a)||!$jscomp.owns(b[a],this.id_)){return !1}return delete b[a][this.id_]};return b},'es6','es3');$jscomp.MapEntry=function(){this.previous;this.next;this.head;this.key;this.value};$jscomp.polyfill('Map',function(b){function isConformant(){if($jscomp.ASSUME_NO_NATIVE_MAP||!b||typeof b!='function'||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=b;var e=Object.seal({x:4});var c=new b($jscomp.makeIterator([[e,'s']]));if(c.get(e)!='s'||c.size!=1||c.get({x:4})||c.set({x:4},'t')!=c||c.size!=2){return !1}var d=c.entries();var a=d.next();if(a.done||a.value[0]!=e||a.value[1]!='s'){return !1}a=d.next();if(a.done||a.value[0].x!=4||a.value[1]!='t'||!d.next().done){return !1}return !0}catch(i){return !1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE){return b}}else {if(isConformant()){return b}}$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=new WeakMap();var a=function(a){this.data_={};this.head_=f();this.size=0;if(a){var e=$jscomp.makeIterator(a);var c;while(!(c=e.next()).done){var d=c.value;this.set(d[0],d[1])}}};a.prototype.set=function(d,e){d=d===0?0:d;var a=c(this,d);if(!a.list){a.list=this.data_[a.id]=[]}if(!a.entry){a.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:d,value:e};a.list.push(a.entry);this.head_.previous.next=a.entry;this.head_.previous=a.entry;this.size++}else {a.entry.value=e}return this};a.prototype['delete']=function(d){var a=c(this,d);if(a.entry&&a.list){a.list.splice(a.index,1);if(!a.list.length){delete this.data_[a.id]}a.entry.previous.next=a.entry.next;a.entry.next.previous=a.entry.previous;a.entry.head=null;this.size--;return !0}return !1};a.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};a.prototype.has=function(a){return !!c(this,a).entry};a.prototype.get=function(d){var a=c(this,d).entry;return a&&a.value};a.prototype.entries=function(){return d(this,function(a){return [a.key,a.value]})};a.prototype.keys=function(){return d(this,function(a){return a.key})};a.prototype.values=function(){return d(this,function(a){return a.value})};a.prototype.forEach=function(e,d){var f=this.entries();var c;while(!(c=f.next()).done){var a=c.value;e.call(d,a[1],a[0],this)}};a.prototype[Symbol.iterator]=a.prototype.entries;var c=function(g,e){var f=h(e);var a=g.data_[f];if(a&&$jscomp.owns(g.data_,f)){for(var d=0;d<a.length;d++){var c=a[d];if(e!==e&&c.key!==c.key||e===c.key){return {id:f,list:a,index:d,entry:c}}}}return {id:f,list:a,index:-1,entry:undefined}};var d=function(c,d){var a=c.head_;return $jscomp.iteratorPrototype(function(){if(a){while(a.head!=c.head_){a=a.previous}while(a.next!=a.head){a=a.next;return {done:!1,value:d(a)}}a=null}return {done:!0,value:void 0}})};var f=function(){var a={};a.previous=a.next=a.head=a;return a};var g=0;var h=function(a){var c=a&&typeof a;if(c=='object'||c=='function'){a=a;if(!e.has(a)){var d=''+ ++g;e.set(a,d);return d}return e.get(a)}return 'p_'+a};return a},'es6','es3');$jscomp.polyfill('Math.acosh',function(a){if(a){return a}var b=function(b){b=Number(b);return Math.log(b+Math.sqrt(b*b-1))};return b},'es6','es3');$jscomp.polyfill('Math.asinh',function(a){if(a){return a}var b=function(b){b=Number(b);if(b===0){return b}var c=Math.log(Math.abs(b)+Math.sqrt(b*b+1));return b<0?-c:c};return b},'es6','es3');$jscomp.polyfill('Math.log1p',function(a){if(a){return a}var b=function(b){b=Number(b);if(b<0.25&&b>-0.25){var f=b;var g=1;var c=b;var d=0;var e=1;while(d!=c){f*=b;e*=-1;c=(d=c)+e*f/++g}return c}return Math.log(1+b)};return b},'es6','es3');$jscomp.polyfill('Math.atanh',function(b){if(b){return b}var a=Math.log1p;var c=function(c){c=Number(c);return (a(c)-a(-c))/2};return c},'es6','es3');$jscomp.polyfill('Math.cbrt',function(a){if(a){return a}var b=function(b){if(b===0){return b}b=Number(b);var c=Math.pow(Math.abs(b),1/3);return b<0?-c:c};return b},'es6','es3');$jscomp.polyfill('Math.clz32',function(a){if(a){return a}var b=function(b){b=Number(b)>>>0;if(b===0){return 32}var c=0;if((b&4.29490176E9)===0){b<<=16;c+=16}if((b&4.27819008E9)===0){b<<=8;c+=8}if((b&4.02653184E9)===0){b<<=4;c+=4}if((b&3.221225472E9)===0){b<<=2;c+=2}if((b&2.147483648E9)===0){c++}return c};return b},'es6','es3');$jscomp.polyfill('Math.cosh',function(a){if(a){return a}var b=Math.exp;var c=function(c){c=Number(c);return (b(c)+b(-c))/2};return c},'es6','es3');$jscomp.polyfill('Math.expm1',function(a){if(a){return a}var b=function(b){b=Number(b);if(b<0.25&&b>-0.25){var e=b;var f=1;var c=b;var d=0;while(d!=c){e*=b/++f;c=(d=c)+e}return c}return Math.exp(b)-1};return b},'es6','es3');$jscomp.polyfill('Math.hypot',function(a){if(a){return a}var b=function(d,e,h){d=Number(d);e=Number(e);var b,g,f;var c=Math.max(Math.abs(d),Math.abs(e));for(b=2;b<arguments.length;b++){c=Math.max(c,Math.abs(arguments[b]))}if(c>1.0E100||c<1.0E-100){if(!c){return c}d=d/c;e=e/c;f=d*d+e*e;for(b=2;b<arguments.length;b++){g=Number(arguments[b])/c;f+=g*g}return Math.sqrt(f)*c}else {f=d*d+e*e;for(b=2;b<arguments.length;b++){g=Number(arguments[b]);f+=g*g}return Math.sqrt(f)}};return b},'es6','es3');$jscomp.polyfill('Math.imul',function(a){if(a){return a}var b=function(b,c){b=Number(b);c=Number(c);var f=b>>>16&65535;var d=b&65535;var g=c>>>16&65535;var e=c&65535;var h=f*e+d*g<<16>>>0;return d*e+h|0};return b},'es6','es3');$jscomp.polyfill('Math.log10',function(a){if(a){return a}var b=function(b){return Math.log(b)/Math.LN10};return b},'es6','es3');$jscomp.polyfill('Math.log2',function(a){if(a){return a}var b=function(b){return Math.log(b)/Math.LN2};return b},'es6','es3');$jscomp.polyfill('Math.sign',function(a){if(a){return a}var b=function(b){b=Number(b);return b===0||isNaN(b)?b:b>0?1:-1};return b},'es6','es3');$jscomp.polyfill('Math.sinh',function(a){if(a){return a}var b=Math.exp;var c=function(c){c=Number(c);if(c===0){return c}return (b(c)-b(-c))/2};return c},'es6','es3');$jscomp.polyfill('Math.tanh',function(a){if(a){return a}var b=function(b){b=Number(b);if(b===0){return b}var c=Math.exp(-2*Math.abs(b));var d=(1-c)/(1+c);return b<0?-d:d};return b},'es6','es3');$jscomp.polyfill('Math.trunc',function(a){if(a){return a}var b=function(b){b=Number(b);if(isNaN(b)||b===Infinity||b===-Infinity||b===0){return b}var c=Math.floor(Math.abs(b));return b<0?-c:c};return b},'es6','es3');$jscomp.polyfill('Number.EPSILON',function(a){return Math.pow(2,-52)},'es6','es3');$jscomp.polyfill('Number.MAX_SAFE_INTEGER',function(){return 9.007199254740991E15},'es6','es3');$jscomp.polyfill('Number.MIN_SAFE_INTEGER',function(){return -9.007199254740991E15},'es6','es3');$jscomp.polyfill('Number.isFinite',function(a){if(a){return a}var b=function(b){if(typeof b!=='number'){return !1}return !isNaN(b)&&b!==Infinity&&b!==-Infinity};return b},'es6','es3');$jscomp.polyfill('Number.isInteger',function(a){if(a){return a}var b=function(b){if(!Number.isFinite(b)){return !1}return b===Math.floor(b)};return b},'es6','es3');$jscomp.polyfill('Number.isNaN',function(a){if(a){return a}var b=function(b){return typeof b==='number'&&isNaN(b)};return b},'es6','es3');$jscomp.polyfill('Number.isSafeInteger',function(a){if(a){return a}var b=function(b){return Number.isInteger(b)&&Math.abs(b)<=Number.MAX_SAFE_INTEGER};return b},'es6','es3');$jscomp.polyfill('Number.parseFloat',function(a){return a||parseFloat},'es6','es3');$jscomp.polyfill('Number.parseInt',function(a){return a||parseInt},'es6','es3');$jscomp.assign=typeof Object.assign=='function'?Object.assign:function(d,e){for(var c=1;c<arguments.length;c++){var a=arguments[c];if(!a){continue}for(var b in a){if($jscomp.owns(a,b)){d[b]=a[b]}}}return d};$jscomp.polyfill('Object.assign',function(a){return a||$jscomp.assign},'es6','es3');$jscomp.polyfill('Object.entries',function(a){if(a){return a}var b=function(c){var d=[];for(var b in c){if($jscomp.owns(c,b)){d.push([b,c[b]])}}return d};return b},'es8','es3');$jscomp.polyfill('Object.getOwnPropertySymbols',function(a){if(a){return a}return function(){return []}},'es6','es5');$jscomp.polyfill('Reflect.ownKeys',function(b){if(b){return b}var a='jscomp_symbol_';function isSymbol(c){return c.substring(0,a.length)==a}var c=function(e){var f=[];var c=Object.getOwnPropertyNames(e);var d=Object.getOwnPropertySymbols(e);for(var a=0;a<c.length;a++){(isSymbol(c[a])?d:f).push(c[a])}return f.concat(d)};return c},'es6','es5');$jscomp.polyfill('Object.getOwnPropertyDescriptors',function(a){if(a){return a}var b=function(e){var d={};var c=Reflect.ownKeys(e);for(var b=0;b<c.length;b++){d[c[b]]=Object.getOwnPropertyDescriptor(e,c[b])}return d};return b},'es8','es5');$jscomp.polyfill('Object.setPrototypeOf',function(a){return a||$jscomp.setPrototypeOf},'es6','es5');$jscomp.polyfill('Object.values',function(a){if(a){return a}var b=function(b){var c=[];for(var d in b){if($jscomp.owns(b,d)){c.push(b[d])}}return c};return b},'es8','es3');$jscomp.polyfill('Reflect.apply',function(a){if(a){return a}var c=Function.prototype.apply;var b=function(e,d,b){return c.call(e,d,b)};return b},'es6','es3');$jscomp.objectCreate=$jscomp.ASSUME_ES5||typeof Object.create=='function'?Object.create:function(b){var a=function(){};a.prototype=b;return new a()};$jscomp.construct=function(){function reflectConstructWorks(){function Base(){}function Derived(){}new Base();Reflect.construct(Base,[],Derived);return new Base() instanceof Base}if(typeof Reflect!='undefined'&&Reflect.construct){if(reflectConstructWorks()){return Reflect.construct}var b=Reflect.construct;var a=function(e,d,a){var c=b(e,d);if(a){Reflect.setPrototypeOf(c,a.prototype)}return c};return a}function construct(b,d,a){if(a===undefined){a=b}var f=a.prototype||Object.prototype;var c=$jscomp.objectCreate(f);var e=Function.prototype.apply;var g=e.call(b,c,d);return g||c}return construct}();$jscomp.polyfill('Reflect.construct',function(a){return $jscomp.construct},'es6','es3');$jscomp.polyfill('Reflect.defineProperty',function(a){if(a){return a}var b=function(e,d,c){try{Object.defineProperty(e,d,c);var b=Object.getOwnPropertyDescriptor(e,d);if(!b){return !1}return b.configurable===(c.configurable||!1)&&b.enumerable===(c.enumerable||!1)&&('value' in b?b.value===c.value&&b.writable===(c.writable||!1):b.get===c.get&&b.set===c.set)}catch(f){return !1}};return b},'es6','es5');$jscomp.polyfill('Reflect.deleteProperty',function(a){if(a){return a}var b=function(c,b){if(!$jscomp.owns(c,b)){return !0}try{return delete c[b]}catch(d){return !1}};return b},'es6','es3');$jscomp.polyfill('Reflect.getOwnPropertyDescriptor',function(a){return a||Object.getOwnPropertyDescriptor},'es6','es5');$jscomp.polyfill('Reflect.getPrototypeOf',function(a){return a||Object.getPrototypeOf},'es6','es5');$jscomp.findDescriptor=function(d,c){var a=d;while(a){var b=Reflect.getOwnPropertyDescriptor(a,c);if(b){return b}a=Reflect.getPrototypeOf(a)}return undefined};$jscomp.polyfill('Reflect.get',function(a){if(a){return a}var b=function(d,c,e){if(arguments.length<=2){return d[c]}var b=$jscomp.findDescriptor(d,c);if(b){return b.get?b.get.call(e):b.value}return undefined};return b},'es6','es5');$jscomp.polyfill('Reflect.has',function(a){if(a){return a}var b=function(c,b){return b in c};return b},'es6','es3');$jscomp.polyfill('Reflect.isExtensible',function(a){if(a){return a}if($jscomp.ASSUME_ES5||typeof Object.isExtensible=='function'){return Object.isExtensible}return function(){return !0}},'es6','es3');$jscomp.polyfill('Reflect.preventExtensions',function(a){if(a){return a}if(!($jscomp.ASSUME_ES5||typeof Object.preventExtensions=='function')){return function(){return !1}}var b=function(b){Object.preventExtensions(b);return !Object.isExtensible(b)};return b},'es6','es3');$jscomp.polyfill('Reflect.set',function(a){if(a){return a}var b=function(b,d,e,f){var c=$jscomp.findDescriptor(b,d);if(!c){if(Reflect.isExtensible(b)){b[d]=e;return !0}return !1}if(c.set){c.set.call(arguments.length>3?f:b,e);return !0}else {if(c.writable&&!Object.isFrozen(b)){b[d]=e;return !0}}return !1};return b},'es6','es5');$jscomp.polyfill('Reflect.setPrototypeOf',function(a){if(a){return a}else {if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;var c=function(c,d){try{b(c,d);return !0}catch(e){return !1}};return c}else {return null}}},'es6','es5');$jscomp.polyfill('Set',function(b){function isConformant(){if($jscomp.ASSUME_NO_NATIVE_SET||!b||typeof b!='function'||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=b;var d=Object.seal({x:4});var c=new b($jscomp.makeIterator([d]));if(!c.has(d)||c.size!=1||c.add(d)!=c||c.size!=1||c.add({x:4})!=c||c.size!=2){return !1}var e=c.entries();var a=e.next();if(a.done||a.value[0]!=d||a.value[1]!=d){return !1}a=e.next();if(a.done||a.value[0]==d||a.value[0].x!=4||a.value[1]!=a.value[0]){return !1}return e.next().done}catch(f){return !1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(b&&$jscomp.ES6_CONFORMANCE){return b}}else {if(isConformant()){return b}}$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=function(a){this.map_=new Map();if(a){var e=$jscomp.makeIterator(a);var c;while(!(c=e.next()).done){var d=c.value;this.add(d)}}this.size=this.map_.size};a.prototype.add=function(a){a=a===0?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};a.prototype['delete']=function(c){var a=this.map_['delete'](c);this.size=this.map_.size;return a};a.prototype.clear=function(){this.map_.clear();this.size=0};a.prototype.has=function(a){return this.map_.has(a)};a.prototype.entries=function(){return this.map_.entries()};a.prototype.values=function(){return this.map_.values()};a.prototype.keys=a.prototype.values;a.prototype[Symbol.iterator]=a.prototype.values;a.prototype.forEach=function(c,a){var d=this;this.map_.forEach(function(e){return c.call(a,e,e,d)})};return a},'es6','es3');$jscomp.checkStringArgs=function(a,c,b){if(a==null){throw new TypeError("The 'this' value for String.prototype."+b+' must not be null or undefined')}if(c instanceof RegExp){throw new TypeError('First argument to String.prototype.'+b+' must not be a regular expression')}return a+''};$jscomp.polyfill('String.prototype.codePointAt',function(a){if(a){return a}var b=function(b){var e=$jscomp.checkStringArgs(this,null,'codePointAt');var f=e.length;b=Number(b)||0;if(!(b>=0&&b<f)){return void 0}b=b|0;var c=e.charCodeAt(b);if(c<55296||c>56319||b+1===f){return c}var d=e.charCodeAt(b+1);if(d<56320||d>57343){return c}return (c-55296)*1024+d+9216};return b},'es6','es3');$jscomp.polyfill('String.prototype.endsWith',function(a){if(a){return a}var b=function(b,c){var d=$jscomp.checkStringArgs(this,b,'endsWith');b=b+'';if(c===void 0){c=d.length}var f=Math.max(0,Math.min(c|0,d.length));var e=b.length;while(e>0&&f>0){if(d[--f]!=b[--e]){return !1}}return e<=0};return b},'es6','es3');$jscomp.polyfill('String.fromCodePoint',function(a){if(a){return a}var b=function(e){var c='';for(var d=0;d<arguments.length;d++){var b=Number(arguments[d]);if(b<0||b>1114111||b!==Math.floor(b)){throw new RangeError('invalid_code_point '+b)}if(b<=65535){c+=String.fromCharCode(b)}else {b-=65536;c+=String.fromCharCode(b>>>10&1023|55296);c+=String.fromCharCode(b&1023|56320)}}return c};return b},'es6','es3');$jscomp.polyfill('String.prototype.includes',function(a){if(a){return a}var b=function(b,c){var d=$jscomp.checkStringArgs(this,b,'includes');return d.indexOf(b,c||0)!==-1};return b},'es6','es3');$jscomp.polyfill('String.prototype.repeat',function(a){if(a){return a}var b=function(b){var c=$jscomp.checkStringArgs(this,null,'repeat');if(b<0||b>1342177279){throw new RangeError('Invalid count value')}b=b|0;var d='';while(b){if(b&1){d+=c}if(b>>>=1){c+=c}}return d};return b},'es6','es3');$jscomp.stringPadding=function(c,a){var b=c!==undefined?String(c):' ';if(!(a>0)||!b){return ''}var d=Math.ceil(a/b.length);return b.repeat(d).substring(0,a)};$jscomp.polyfill('String.prototype.padEnd',function(a){if(a){return a}var b=function(d,c){var b=$jscomp.checkStringArgs(this,null,'padStart');var e=d-b.length;return b+$jscomp.stringPadding(c,e)};return b},'es8','es3');$jscomp.polyfill('String.prototype.padStart',function(a){if(a){return a}var b=function(d,c){var b=$jscomp.checkStringArgs(this,null,'padStart');var e=d-b.length;return $jscomp.stringPadding(c,e)+b};return b},'es8','es3');$jscomp.polyfill('String.prototype.startsWith',function(a){if(a){return a}var b=function(b,g){var c=$jscomp.checkStringArgs(this,b,'startsWith');b=b+'';var h=c.length;var e=b.length;var f=Math.max(0,Math.min(g|0,c.length));var d=0;while(d<e&&f<h){if(c[f++]!=b[d++]){return !1}}return d>=e};return b},'es6','es3');$jscomp.arrayFromIterator=function(c){var b;var a=[];while(!(b=c.next()).done){a.push(b.value)}return a};$jscomp.arrayFromIterable=function(a){if(a instanceof Array){return a}else {return $jscomp.arrayFromIterator($jscomp.makeIterator(a))}};$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var e=$jscomp.setPrototypeOf;e(a,b)}else {for(var c in b){if(c=='prototype'){continue}if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);if(d){Object.defineProperty(a,c,d)}}else {a[c]=b[c]}}}a.superClass_=b.prototype};$jscomp.polyfill('WeakSet',function(a){function isConformant(){if(!a||!Object.seal){return !1}try{var c=Object.seal({});var d=Object.seal({});var b=new a([c]);if(!b.has(c)||b.has(d)){return !1}b['delete'](c);b.add(d);return !b.has(c)&&b.has(d)}catch(e){return !1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE){return a}}else {if(isConformant()){return a}}var b=function(b){this.map_=new WeakMap();if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=$jscomp.makeIterator(b);var c;while(!(c=e.next()).done){var d=c.value;this.add(d)}}};b.prototype.add=function(b){this.map_.set(b,!0);return this};b.prototype.has=function(b){return this.map_.has(b)};b.prototype['delete']=function(b){return this.map_['delete'](b)};return b},'es6','es3');try{if(Array.prototype.values.toString().indexOf('[native code]')==-1){delete Array.prototype.values}}catch(a){}(function(a,j){var b={},d=function(b,g){var d,f,c;if(typeof b==='string'){return e(b)}else {d=[];for(f=b.length,c=0;c<f;c++){d.push(e(b[c]))}return g.apply(null,d)}},i=function(e,b,c){if(arguments.length===2){c=b;b=null}d(b||[],function(){h(e,c,arguments)})},h=function(h,f,g){var c={exports:f},e;if(typeof f==='function'){g.length||(g=[d,c.exports,c]);e=f.apply(null,g);e!==undefined&&(c.exports=e)}b[h]=c.exports},e=function(c){var d=b[c]||a[c];if(!d){throw new Error('`'+c+'` is undefined')}return d},g=function(i){var e,c,g,d,h,f;f=function(b){return b&&b.charAt(0).toUpperCase()+b.substr(1)};for(e in b){c=i;if(!b.hasOwnProperty(e)){continue}g=e.split('/');h=f(g.pop());while(d=f(g.shift())){c[d]=c[d]||{};c=c[d]}c[h]=b[e]}return i},c=function(b){a.__dollar=b;return g(j(a,i,d))},f;if(typeof module==='object'&&typeof module.exports==='object'){module.exports=c()}else {if(typeof define==='function'&&define.amd){define(['jquery'],c)}else {f=a.WebUploader;a.WebUploader=c();a.WebUploader.noConflict=function(){a.WebUploader=f}}}})(window,function(b,a,c){a('dollar-third',[],function(){var d=b.require;var e=b.__dollar||b.jQuery||b.Zepto||d('jquery')||d('zepto');if(!e){throw new Error('jQuery or Zepto not found!')}return e});a('dollar',['dollar-third'],function(d){return d});a('promise-third',['dollar'],function(d){return {Deferred:d.Deferred,when:d.when,isPromise:function(e){return e&&typeof e.then==='function'}}});a('promise',['promise-third'],function(d){return d});a('base',['dollar','promise'],function(e,d){var f=function(){},g=Function.call;function uncurryThis(f){return function(){return g.apply(f,arguments)}}function bindFn(g,f){return function(){return g.apply(f,arguments)}}function createObject(g){var f;if(Object.create){return Object.create(g)}else {f=function(){};f.prototype=g;return new f()}}return {version:'0.1.8-alpha',$:e,Deferred:d.Deferred,isPromise:d.isPromise,when:d.when,browser:function(f){var g={},k=f.match(/WebKit\/([\d.]+)/),i=f.match(/Chrome\/([\d.]+)/)||f.match(/CriOS\/([\d.]+)/),m=f.match(/MSIE\s([\d\.]+)/)||f.match(/(?:trident)(?:.*rv:([\w.]+))?/i),h=f.match(/Firefox\/([\d.]+)/),j=f.match(/Safari\/([\d.]+)/),l=f.match(/OPR\/([\d.]+)/);k&&(g.webkit=parseFloat(k[1]));i&&(g.chrome=parseFloat(i[1]));m&&(g.ie=parseFloat(m[1]));h&&(g.firefox=parseFloat(h[1]));j&&(g.safari=parseFloat(j[1]));l&&(g.opera=parseFloat(l[1]));return g}(navigator.userAgent),os:function(i){var f={},g=i.match(/(?:Android);?[\s\/]+([\d.]+)?/),h=i.match(/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/);g&&(f.android=parseFloat(g[1]));h&&(f.ios=parseFloat(h[1].replace(/_/g,'.')));return f}(navigator.userAgent),inherits:function(h,f,i){var g;if(typeof f==='function'){g=f;f=null}else {if(f&&f.hasOwnProperty('constructor')){g=f.constructor}else {g=function(){return h.apply(this,arguments)}}}e.extend(!0,g,h,i||{});g.__super__=h.prototype;g.prototype=createObject(h.prototype);f&&e.extend(!0,g.prototype,f);return g},noop:f,bindFn:bindFn,log:function(){if(b.console){return bindFn(console.log,console)}return f}(),nextTick:function(){return function(f){setTimeout(f,1)}}(),slice:uncurryThis([].slice),guid:function(){var f=0;return function(i){var g=(+new Date()).toString(32),h=0;for(;h<5;h++){g+=Math.floor(Math.random()*65535).toString(32)}return (i||'wu_')+g+(f++).toString(32)}}(),formatSize:function(f,i,g){var h;g=g||['B','K','M','G','TB'];while((h=g.shift())&&f>1024){f=f/1024}return (h==='B'?f:f.toFixed(i||2))+h}}});a('mediator',['base'],function(h){var d=h.$,g=[].slice,f=/\s+/,e;function findHandlers(i,g,e,f){return d.grep(i,function(d){return d&&(!g||d.e===g)&&(!e||d.cb===e||d.cb._cb===e)&&(!f||d.ctx===f)})}function eachEvent(i,e,g){d.each((i||'').split(f),function(f,d){g(d,e)})}function triggerHanders(e,i){var f=!1,g=-1,j=e.length,d;while(++g<j){d=e[g];if(d.cb.apply(d.ctx2,i)===!1){f=!0;break}}return !f}e={on:function(g,e,f){var i=this,d;if(!e){return this}d=this._events||(this._events=[]);eachEvent(g,e,function(l,k){var j={e:l};j.cb=k;j.ctx=f;j.ctx2=f||i;j.id=d.length;d.push(j)});return this},once:function(g,e,f){var d=this;if(!e){return d}eachEvent(g,e,function(k,j){var i=function(){d.off(k,i);return j.apply(f||d,arguments)};i._cb=j;d.on(k,i,f)});return d},off:function(f,i,g){var e=this._events;if(!e){return this}if(!f&&!i&&!g){this._events=[];return this}eachEvent(f,i,function(j,k){d.each(findHandlers(e,j,k,g),function(){delete e[this.id]})});return this},trigger:function(i){var f,e,d;if(!this._events||!i){return this}f=g.call(arguments,1);e=findHandlers(this._events,i);d=findHandlers(this._events,'all');return triggerHanders(e,f)&&triggerHanders(d,arguments)}};return d.extend({installTo:function(f){return d.extend(f,e)}},e)});a('uploader',['base','mediator'],function(f,e){var d=f.$;function Uploader(g){this.options=d.extend(!0,{},Uploader.options,g);this._init(this.options)}Uploader.options={};e.installTo(Uploader.prototype);d.each({upload:'start-upload',stop:'stop-upload',getFile:'get-file',getFiles:'get-files',addFile:'add-file',addFiles:'add-file',sort:'sort-files',removeFile:'remove-file',cancelFile:'cancel-file',skipFile:'skip-file',retry:'retry',isInProgress:'is-in-progress',makeThumb:'make-thumb',md5File:'md5-file',getDimension:'get-dimension',addButton:'add-btn',predictRuntimeType:'predict-runtime-type',refresh:'refresh',disable:'disable',enable:'enable',reset:'reset'},function(g,d){Uploader.prototype[g]=function(){return this.request(d,arguments)}});d.extend(Uploader.prototype,{state:'pending',_init:function(g){var d=this;d.request('init',g,function(){d.state='ready';d.trigger('ready')})},option:function(h,i){var g=this.options;if(arguments.length>1){if(d.isPlainObject(i)&&d.isPlainObject(g[h])){d.extend(g[h],i)}else {g[h]=i}}else {return h?g[h]:g}},getStats:function(){var d=this.request('get-stats');return d?{successNum:d.numOfSuccess,progressNum:d.numOfProgress,cancelNum:d.numOfCancel,invalidNum:d.numOfInvalid,uploadFailNum:d.numOfUploadFailed,queueNum:d.numOfQueue,interruptNum:d.numOfInterrupt}:{}},trigger:function(i){var h=[].slice.call(arguments,1),j=this.options,g='on'+i.substring(0,1).toUpperCase()+i.substring(1);if(e.trigger.apply(this,arguments)===!1||d.isFunction(j[g])&&j[g].apply(this,h)===!1||d.isFunction(this[g])&&this[g].apply(this,h)===!1||e.trigger.apply(e,[this,i].concat(h))===!1){return !1}return !0},destroy:function(){this.request('destroy',arguments);this.off()},request:f.noop});f.create=Uploader.create=function(d){return new Uploader(d)};f.Uploader=Uploader;return Uploader});a('runtime/runtime',['base','mediator'],function(f,h){var e=f.$,d={},g=function(e){for(var d in e){if(e.hasOwnProperty(d)){return d}}return null};function Runtime(d){this.options=e.extend({container:document.body},d);this.uid=f.guid('rt_')}e.extend(Runtime.prototype,{getContainer:function(){var i=this.options,g,d;if(this._container){return this._container}g=e(i.container||document.body);d=e(document.createElement('div'));d.attr('id','rt_'+this.uid);d.css({position:'absolute',top:'0px',left:'0px',width:'1px',height:'1px',overflow:'hidden'});g.append(d);g.addClass('webuploader-container');this._container=d;this._parent=g;return d},init:f.noop,exec:f.noop,destroy:function(){this._container&&this._container.remove();this._parent&&this._parent.removeClass('webuploader-container');this.off()}});Runtime.orders='html5,flash';Runtime.addRuntime=function(g,e){d[g]=e};Runtime.hasRuntime=function(e){return !!(e?d[e]:g(d))};Runtime.create=function(l,j){var i,k;j=j||Runtime.orders;e.each(j.split(/\s*,\s*/g),function(){if(d[this]){i=this;return !1}});i=i||g(d);if(!i){throw new Error('Runtime Error')}k=new d[i](l);return k};h.installTo(Runtime.prototype);return Runtime});a('runtime/client',['base','mediator','runtime/runtime'],function(e,f,g){var d;d=function(){var d={};return {add:function(h){d[h.uid]=h},get:function(i,j){var h;if(i){return d[i]}for(h in d){if(j&&d[h].__standalone){continue}return d[h]}return null},remove:function(h){delete d[h.uid]}}}();function RuntimeClient(k,j){var i=e.Deferred(),h;this.uid=e.guid('client_');this.runtimeReady=function(d){return i.done(d)};this.connectRuntime=function(l,m){if(h){throw new Error('already connected!')}i.done(m);if(typeof l==='string'&&d.get(l)){h=d.get(l)}h=h||d.get(null,j);if(!h){h=g.create(l,l.runtimeOrder);h.__promise=i.promise();h.once('ready',i.resolve);h.init();d.add(h);h.__client=1}else {e.$.extend(h.options,l);h.__promise.then(i.resolve);h.__client++}j&&(h.__standalone=j);return h};this.getRuntime=function(){return h};this.disconnectRuntime=function(){if(!h){return}h.__client--;if(h.__client<=0){d.remove(h);delete h.__promise;h.destroy()}h=null};this.exec=function(){if(!h){return}var d=e.slice(arguments);k&&d.unshift(k);return h.exec.apply(this,d)};this.getRuid=function(){return h&&h.uid};this.destroy=function(d){return function(){d&&d.apply(this,arguments);this.trigger('destroy');this.off();this.exec('destroy');this.disconnectRuntime()}}(this.destroy)}f.installTo(RuntimeClient.prototype);return RuntimeClient});a('lib/dnd',['base','mediator','runtime/client'],function(e,g,d){var f=e.$;function DragAndDrop(h){h=this.options=f.extend({},DragAndDrop.options,h);h.container=f(h.container);if(!h.container.length){return}d.call(this,'DragAndDrop')}DragAndDrop.options={accept:null,disableGlobalDnd:!1};e.inherits(d,{constructor:DragAndDrop,init:function(){var f=this;f.connectRuntime(f.options,function(){f.exec('init');f.trigger('ready')})}});g.installTo(DragAndDrop.prototype);return DragAndDrop});a('widgets/widget',['base','uploader'],function(d,g){var e=d.$,j=g.prototype._init,i=g.prototype.destroy,h={},f=[];function isArrayLike(h){if(!h){return !1}var f=h.length,i=e.type(h);if(h.nodeType===1&&f){return !0}return i==='array'||i!=='function'&&i!=='string'&&(f===0||typeof f==='number'&&f>0&&f-1 in h)}function Widget(e){this.owner=e;this.options=e.options}e.extend(Widget.prototype,{init:d.noop,invoke:function(i,j){var f=this.responseMap;if(!f||!(i in f)||!(f[i] in this)||!e.isFunction(this[f[i]])){return h}return this[f[i]].apply(this,j)},request:function(){return this.owner.request.apply(this.owner,arguments)}});e.extend(g.prototype,{_init:function(){var h=this,k=h._widgets=[],i=h.options.disableWidgets||'';e.each(f,function(f,e){(!i||!~i.indexOf(e._name))&&k.push(new e(h))});return j.apply(h,arguments)},request:function(q,e,i){var n=0,k=this._widgets,r=k&&k.length,p=[],l=[],o,f,j,m;e=isArrayLike(e)?e:[e];for(;n<r;n++){o=k[n];f=o.invoke(q,e);if(f!==h){if(d.isPromise(f)){l.push(f)}else {p.push(f)}}}if(i||l.length){j=d.when.apply(d,l);m=j.pipe?'pipe':'then';return j[m](function(){var h=d.Deferred(),f=arguments;if(f.length===1){f=f[0]}setTimeout(function(){h.resolve(f)},1);return h.promise()})[i?m:'done'](i||d.noop)}else {return p[0]}},destroy:function(){i.apply(this,arguments);this._widgets=null}});g.register=Widget.register=function(k,i){var h={init:'init',destroy:'destroy',name:'anonymous'},j;if(arguments.length===1){i=k;e.each(i,function(e){if(e[0]==='_'||e==='name'){e==='name'&&(h.name=i.name);return}h[e.replace(/[A-Z]/g,'-$&').toLowerCase()]=e})}else {h=e.extend(h,k)}i.responseMap=h;j=d.inherits(Widget,i);j._name=h.name;f.push(j);return j};g.unRegister=Widget.unRegister=function(e){if(!e||e==='anonymous'){return}for(var h=f.length;h--;){if(f[h]._name===e){f.splice(h,1)}}};return Widget});a('widgets/filednd',['base','uploader','lib/dnd','widgets/widget'],function(e,d,f){var g=e.$;d.options.dnd='';return d.register({name:'dnd',init:function(i){if(!i.dnd||this.request('predict-runtime-type')!=='html5'){return}var k=this,j=e.Deferred(),l=g.extend({},{disableGlobalDnd:i.disableGlobalDnd,container:i.dnd,accept:i.accept}),h;this.dnd=h=new f(l);h.once('ready',j.resolve);h.on('drop',function(g){k.request('add-file',[g])});h.on('accept',function(g){return k.owner.trigger('dndAccept',g)});h.init();return j.promise()},destroy:function(){this.dnd&&this.dnd.destroy()}})});a('lib/filepaste',['base','mediator','runtime/client'],function(e,g,d){var f=e.$;function FilePaste(h){h=this.options=f.extend({},h);h.container=f(h.container||document.body);d.call(this,'FilePaste')}e.inherits(d,{constructor:FilePaste,init:function(){var f=this;f.connectRuntime(f.options,function(){f.exec('init');f.trigger('ready')})}});g.installTo(FilePaste.prototype);return FilePaste});a('widgets/filepaste',['base','uploader','lib/filepaste','widgets/widget'],function(d,f,e){var g=d.$;return f.register({name:'paste',init:function(i){if(!i.paste||this.request('predict-runtime-type')!=='html5'){return}var l=this,j=d.Deferred(),k=g.extend({},{container:i.paste,accept:i.accept}),h;this.paste=h=new e(k);h.once('ready',j.resolve);h.on('paste',function(g){l.owner.request('add-file',[g])});h.init();return j.promise()},destroy:function(){this.paste&&this.paste.destroy()}})});a('lib/blob',['base','runtime/client'],function(e,d){function Blob(h,f){var g=this;g.source=f;g.ruid=h;this.size=f.size||0;if(!f.type&&this.ext&&~'jpg,jpeg,png,gif,bmp'.indexOf(this.ext)){this.type='image/'+(this.ext==='jpg'?'jpeg':this.ext)}else {this.type=f.type||'application/octet-stream'}d.call(g,'Blob');this.uid=f.uid||this.uid;if(h){g.connectRuntime(h)}}e.inherits(d,{constructor:Blob,slice:function(f,g){return this.exec('slice',f,g)},getSource:function(){return this.source}});return Blob});a('lib/file',['base','lib/blob'],function(e,d){var g=1,f=/\.([^.]+)$/;function File(j,h){var i;this.name=h.name||'untitled'+g++;i=f.exec(h.name)?RegExp.$1.toLowerCase():'';if(!i&&h.type){i=/\/(jpg|jpeg|png|gif|bmp)$/i.exec(h.type)?RegExp.$1.toLowerCase():'';this.name+='.'+i}this.ext=i;this.lastModifiedDate=h.lastModifiedDate||h.lastModified&&(new Date(h.lastModified)).toLocaleString()||(new Date()).toLocaleString();d.apply(this,arguments)}return e.inherits(d,File)});a('lib/filepicker',['base','runtime/client','lib/file'],function(e,f,g){var d=e.$;function FilePicker(h){h=this.options=d.extend({},FilePicker.options,h);h.container=d(h.id);if(!h.container.length){throw new Error('按钮指定错误')}h.innerHTML=h.innerHTML||h.label||h.container.html()||'';h.button=d(h.button||document.createElement('div'));h.button.html(h.innerHTML);h.container.html(h.button);f.call(this,'FilePicker',!0)}FilePicker.options={button:null,container:null,label:null,innerHTML:null,multiple:!0,accept:null,name:'file',style:'webuploader-pick'};e.inherits(f,{constructor:FilePicker,init:function(){var h=this,i=h.options,j=i.button,k=i.style;if(k){j.addClass('webuploader-pick')}h.on('all',function(m){var l;switch(m){case 'mouseenter':if(k){j.addClass('webuploader-pick-hover')};break;case 'mouseleave':if(k){j.removeClass('webuploader-pick-hover')};break;case 'change':l=h.exec('getFiles');h.trigger('select',d.map(l,function(d){d=new g(h.getRuid(),d);d._refer=i.container;return d}),i.container);break;}});h.connectRuntime(i,function(){h.refresh();h.exec('init',i);h.trigger('ready')});this._resizeHandler=e.bindFn(this.refresh,this);d(b).on('resize',this._resizeHandler)},refresh:function(){var j=this.getRuntime().getContainer(),d=this.options.button,i=d[0]&&d[0].offsetWidth||d.outerWidth()||d.width(),h=d[0]&&d[0].offsetHeight||d.outerHeight()||d.height(),k=d.offset();i&&h&&j.css({bottom:'auto',right:'auto',width:i+'px',height:h+'px'}).offset(k)},enable:function(){var d=this.options.button;d.removeClass('webuploader-pick-disable');this.refresh()},disable:function(){var d=this.options.button;this.getRuntime().getContainer().css({top:'-99999px'});d.addClass('webuploader-pick-disable')},destroy:function(){var h=this.options.button;d(b).off('resize',this._resizeHandler);h.removeClass('webuploader-pick-disable webuploader-pick-hover '+'webuploader-pick')}});return FilePicker});a('widgets/filepicker',['base','uploader','lib/filepicker','widgets/widget'],function(e,f,g){var d=e.$;d.extend(f.options,{pick:null,accept:null});return f.register({name:'picker',init:function(d){this.pickers=[];return d.pick&&this.addBtn(d.pick)},refresh:function(){d.each(this.pickers,function(){this.refresh()})},addBtn:function(h){var i=this,k=i.options,j=k.accept,l=[];if(!h){return}d.isPlainObject(h)||(h={id:h});d(h.id).each(function(){var o,m,n;n=e.Deferred();o=d.extend({},h,{accept:d.isPlainObject(j)?[j]:j,swf:k.swf,runtimeOrder:k.runtimeOrder,id:this});m=new g(o);m.once('ready',n.resolve);m.on('select',function(d){i.owner.request('add-file',[d])});m.on('dialogopen',function(){i.owner.trigger('dialogOpen',m.button)});m.init();i.pickers.push(m);l.push(n.promise())});return e.when.apply(e,l)},disable:function(){d.each(this.pickers,function(){this.disable()})},enable:function(){d.each(this.pickers,function(){this.enable()})},destroy:function(){d.each(this.pickers,function(){this.destroy()});this.pickers=null}})});a('lib/image',['base','runtime/client','lib/blob'],function(d,e,f){var g=d.$;function Image(h){this.options=g.extend({},Image.options,h);e.call(this,'Image');this.on('load',function(){this._info=this.exec('info');this._meta=this.exec('meta')})}Image.options={quality:90,crop:!1,preserveHeaders:!1,allowMagnify:!1};d.inherits(e,{constructor:Image,info:function(g){if(g){this._info=g;return this}return this._info},meta:function(g){if(g){this._meta=g;return this}return this._meta},loadFromBlob:function(h){var g=this,i=h.getRuid();this.connectRuntime(i,function(){g.exec('init',g.options);g.exec('loadFromBlob',h)})},resize:function(){var g=d.slice(arguments);return this.exec.apply(this,['resize'].concat(g))},crop:function(){var g=d.slice(arguments);return this.exec.apply(this,['crop'].concat(g))},getAsDataUrl:function(g){return this.exec('getAsDataUrl',g)},getAsBlob:function(h){var g=this.exec('getAsBlob',h);return new f(this.getRuid(),g)}});return Image});a('widgets/image',['base','uploader','lib/image','widgets/widget'],function(h,e,g){var d=h.$,f;f=function(j){var d=0,f=[],i=function(){var i;while(f.length&&d<j){i=f.shift();d+=i[0];i[1]()}};return function(l,k,m){f.push([k,m]);l.once('destroy',function(){d-=k;setTimeout(i,1)});setTimeout(i,1)}}(5*1024*1024);d.extend(e.options,{thumb:{width:110,height:110,quality:70,allowMagnify:!0,crop:!0,preserveHeaders:!1,type:'image/jpeg'},compress:{width:1600,height:1600,quality:90,allowMagnify:!1,crop:!1,preserveHeaders:!0}});return e.register({name:'image',makeThumb:function(i,n,k,l){var m,j;i=this.request('get-file',i);if(!i.type.match(/^image/)){n(!0);return}m=d.extend({},this.options.thumb);if(d.isPlainObject(k)){m=d.extend(m,k);k=null}k=k||m.width;l=l||m.height;j=new g(m);j.once('load',function(){i._info=i._info||j.info();i._meta=i._meta||j.meta();if(k<=1&&k>0){k=i._info.width*k}if(l<=1&&l>0){l=i._info.height*l}j.resize(k,l)});j.once('complete',function(){n(!1,j.getAsDataUrl(m.type));j.destroy()});j.once('error',function(d){n(d||!0);j.destroy()});f(j,i.source.size,function(){i._info&&j.info(i._info);i._meta&&j.meta(i._meta);j.loadFromBlob(i.source)})},beforeSendFile:function(f){var j=this.options.compress||this.options.resize,m=j&&j.compressSize||0,l=j&&j.noCompressIfLarger||!1,i,k;f=this.request('get-file',f);if(!j||!~'image/jpeg,image/jpg'.indexOf(f.type)||f.size<m||f._compressed){return}j=d.extend({},j);k=h.Deferred();i=new g(j);k.always(function(){i.destroy();i=null});i.once('error',k.reject);i.once('load',function(){var k=j.width,d=j.height;f._info=f._info||i.info();f._meta=f._meta||i.meta();if(k<=1&&k>0){k=f._info.width*k}if(d<=1&&d>0){d=f._info.height*d}i.resize(k,d)});i.once('complete',function(){var d,m;try{d=i.getAsBlob(j.type);m=f.size;if(!l||d.size<m){f.source=d;f.size=d.size;f.trigger('resize',d.size,m)}f._compressed=!0;k.resolve()}catch(n){k.resolve()}});f._info&&i.info(f._info);f._meta&&i.meta(f._meta);i.loadFromBlob(f.source);return k.promise()}})});a('file',['base','mediator'],function(h,e){var j=h.$,f='WU_FILE_',g=0,i=/\.([^.]+)$/,d={};function gid(){return f+g++}function WUFile(f){this.name=f.name||'Untitled';this.size=f.size||0;this.type=f.type||'application/octet-stream';this.lastModifiedDate=f.lastModifiedDate||new Date()*1;this.id=gid();this.ext=i.exec(this.name)?RegExp.$1:'';this.statusText='';d[this.id]=WUFile.Status.INITED;this.source=f;this.loaded=0;this.on('error',function(d){this.setStatus(WUFile.Status.ERROR,d)})}j.extend(WUFile.prototype,{setStatus:function(f,i){var g=d[this.id];typeof i!=='undefined'&&(this.statusText=i);if(f!==g){d[this.id]=f;this.trigger('statuschange',f,g)}},getStatus:function(){return d[this.id]},getSource:function(){return this.source},destroy:function(){this.off();delete d[this.id]}});e.installTo(WUFile.prototype);WUFile.Status={INITED:'inited',QUEUED:'queued',PROGRESS:'progress',ERROR:'error',COMPLETE:'complete',CANCELLED:'cancelled',INTERRUPT:'interrupt',INVALID:'invalid'};return WUFile});a('queue',['base','mediator','file'],function(h,f,g){var e=h.$,d=g.Status;function Queue(){this.stats={numOfQueue:0,numOfSuccess:0,numOfCancel:0,numOfProgress:0,numOfUploadFailed:0,numOfInvalid:0,numOfDeleted:0,numOfInterrupt:0};this._queue=[];this._map={}}e.extend(Queue.prototype,{append:function(d){this._queue.push(d);this._fileAdded(d);return this},prepend:function(d){this._queue.unshift(d);this._fileAdded(d);return this},getFile:function(d){if(typeof d!=='string'){return d}return this._map[d]},fetch:function(i){var k=this._queue.length,e,j;i=i||d.QUEUED;for(e=0;e<k;e++){j=this._queue[e];if(i===j.getStatus()){return j}}return null},sort:function(d){if(typeof d==='function'){this._queue.sort(d)}},getFiles:function(){var k=[].slice.call(arguments,0),j=[],i=0,l=this._queue.length,d;for(;i<l;i++){d=this._queue[i];if(k.length&&!~e.inArray(d.getStatus(),k)){continue}j.push(d)}return j},removeFile:function(d){var i=this,e=this._map[d.id];if(e){delete this._map[d.id];this._delFile(d);d.destroy();this.stats.numOfDeleted++}},_fileAdded:function(d){var i=this,e=this._map[d.id];if(!e){this._map[d.id]=d;d.on('statuschange',function(e,j){i._onFileStatusChange(e,j)})}},_delFile:function(e){for(var d=this._queue.length-1;d>=0;d--){if(this._queue[d]==e){this._queue.splice(d,1);break}}},_onFileStatusChange:function(i,j){var e=this.stats;switch(j){case d.PROGRESS:e.numOfProgress--;break;case d.QUEUED:e.numOfQueue--;break;case d.ERROR:e.numOfUploadFailed--;break;case d.INVALID:e.numOfInvalid--;break;case d.INTERRUPT:e.numOfInterrupt--;break;}switch(i){case d.QUEUED:e.numOfQueue++;break;case d.PROGRESS:e.numOfProgress++;break;case d.ERROR:e.numOfUploadFailed++;break;case d.COMPLETE:e.numOfSuccess++;break;case d.CANCELLED:e.numOfCancel++;break;case d.INVALID:e.numOfInvalid++;break;case d.INTERRUPT:e.numOfInterrupt++;break;}}});f.installTo(Queue.prototype);return Queue});a('widgets/queue',['base','uploader','queue','file','lib/file','runtime/client','widgets/widget'],function(g,k,f,e,h,j){var i=g.$,l=/\.\w+$/,d=e.Status;return k.register({name:'queue',init:function(d){var l=this,o,s,n,q,m,r,p;if(i.isPlainObject(d.accept)){d.accept=[d.accept]}if(d.accept){m=[];for(n=0,s=d.accept.length;n<s;n++){q=d.accept[n].extensions;q&&m.push(q)}if(m.length){r='\\.'+m.join(',').replace(/,/g,'$|\\.').replace(/\*/g,'.*')+'$'}l.accept=new RegExp(r,'i')}l.queue=new f();l.stats=l.queue.stats;if(this.request('predict-runtime-type')!=='html5'){return}o=g.Deferred();this.placeholder=p=new j('Placeholder');p.connectRuntime({runtimeOrder:'html5'},function(){l._ruid=p.getRuid();o.resolve()});return o.promise()},_wrapFile:function(d){if(!(d instanceof e)){if(!(d instanceof h)){if(!this._ruid){throw new Error("Can't add external files.")}d=new h(this._ruid,d)}d=new e(d)}return d},acceptFile:function(d){var i=!d||!d.size||this.accept&&l.exec(d.name)&&!this.accept.test(d.name);return !i},_addFile:function(d){var i=this;d=i._wrapFile(d);if(!i.owner.trigger('beforeFileQueued',d)){return}if(!i.acceptFile(d)){i.owner.trigger('error','Q_TYPE_DENIED',d);return}i.queue.append(d);i.owner.trigger('fileQueued',d);return d},getFile:function(d){return this.queue.getFile(d)},addFile:function(d){var l=this;if(!d.length){d=[d]}d=i.map(d,function(i){return l._addFile(i)});if(d.length){l.owner.trigger('filesQueued',d);if(l.options.auto){setTimeout(function(){l.request('start-upload')},20)}}},getStats:function(){return this.stats},removeFile:function(d,i){var l=this;d=d.id?d:l.queue.getFile(d);this.request('cancel-file',d);if(i){this.queue.removeFile(d)}},getFiles:function(){return this.queue.getFiles.apply(this.queue,arguments)},fetchFile:function(){return this.queue.fetch.apply(this.queue,arguments)},retry:function(i,p){var l=this,n,m,o;if(i){i=i.id?i:l.queue.getFile(i);i.setStatus(d.QUEUED);p||l.request('start-upload');return}n=l.queue.getFiles(d.ERROR);m=0;o=n.length;for(;m<o;m++){i=n[m];i.setStatus(d.QUEUED)}l.request('start-upload')},sortFiles:function(){return this.queue.sort.apply(this.queue,arguments)},reset:function(){this.owner.trigger('reset');this.queue=new f();this.stats=this.queue.stats},destroy:function(){this.reset();this.placeholder&&this.placeholder.destroy()}})});a('widgets/runtime',['uploader','runtime/runtime','widgets/widget'],function(e,d){e.support=function(){return d.hasRuntime.apply(d,arguments)};return e.register({name:'runtime',init:function(){if(!this.predictRuntimeType()){throw Error('Runtime Error')}},predictRuntimeType:function(){var f=this.options.runtimeOrder||d.orders,h=this.type,g,i;if(!h){f=f.split(/\s*,\s*/g);for(g=0,i=f.length;g<i;g++){if(d.hasRuntime(f[g])){this.type=h=f[g];break}}}return h}})});a('lib/transport',['base','runtime/client','mediator'],function(g,e,f){var d=g.$;function Transport(h){var i=this;h=i.options=d.extend(!0,{},Transport.options,h||{});e.call(this,'Transport');this._blob=null;this._formData=h.formData||{};this._headers=h.headers||{};this.on('progress',this._timeout);this.on('load error',function(){i.trigger('progress',1);clearTimeout(i._timer)})}Transport.options={server:'',method:'POST',withCredentials:!1,fileVal:'file',timeout:2*60*1000,formData:{},headers:{},sendAsBinary:!1};d.extend(Transport.prototype,{appendBlob:function(k,i,j){var d=this,h=d.options;if(d.getRuid()){d.disconnectRuntime()}d.connectRuntime(i.ruid,function(){d.exec('init')});d._blob=i;h.fileVal=k||h.fileVal;h.filename=j||h.filename},append:function(h,i){if(typeof h==='object'){d.extend(this._formData,h)}else {this._formData[h]=i}},setRequestHeader:function(h,i){if(typeof h==='object'){d.extend(this._headers,h)}else {this._headers[h]=i}},send:function(d){this.exec('send',d);this._timeout()},abort:function(){clearTimeout(this._timer);return this.exec('abort')},destroy:function(){this.trigger('destroy');this.off();this.exec('destroy');this.disconnectRuntime()},getResponseHeaders:function(){return this.exec('getResponseHeaders')},getResponse:function(){return this.exec('getResponse')},getResponseAsJson:function(){return this.exec('getResponseAsJson')},getStatus:function(){return this.exec('getStatus')},_timeout:function(){var d=this,h=d.options.timeout;if(!h){return}clearTimeout(d._timer);d._timer=setTimeout(function(){d.abort();d.trigger('error','timeout')},h)}});f.installTo(Transport.prototype);return Transport});a('widgets/upload',['base','uploader','file','lib/transport','widgets/widget'],function(f,h,j,i){var e=f.$,g=f.isPromise,d=j.Status;e.extend(h.options,{prepareNextFile:!1,chunked:!1,chunkSize:5*1024*1024,chunkRetry:2,chunkRetryDelay:1000,threads:3,formData:{}});function CuteFile(e,g){var d=[],q=e.source,l=q.size,o=g?Math.ceil(l/g):1,k=0,p=0,n,m;m={file:e,has:function(){return !!d.length},shift:function(){return d.shift()},unshift:function(k){d.unshift(k)}};while(p<o){n=Math.min(g,l-k);d.push({file:e,start:k,end:g?k+n:l,total:l,chunks:o,chunk:p++,cuted:m});k+=n}e.blocks=d.concat();e.remaning=d.length;return m}h.register({name:'upload',init:function(){var d=this.owner,g=this;this.runing=!1;this.progress=!1;d.on('startUpload',function(){g.progress=!0}).on('uploadFinished',function(){g.progress=!1});this.pool=[];this.stack=[];this.pending=[];this.remaning=0;this.__tick=f.bindFn(this._tick,this);d.on('uploadComplete',function(d){d.blocks&&e.each(d.blocks,function(g,e){e.transport&&(e.transport.abort(),e.transport.destroy());delete e.transport});delete d.blocks;delete d.remaning})},reset:function(){this.request('stop-upload',!0);this.runing=!1;this.pool=[];this.stack=[];this.pending=[];this.remaning=0;this._trigged=!1;this._promise=null},startUpload:function(k){var g=this;e.each(g.request('get-files',d.INVALID),function(){g.request('remove-file',this)});if(k){k=k.id?k:g.request('get-file',k);if(k.getStatus()===d.INTERRUPT){k.setStatus(d.QUEUED);e.each(g.pool,function(g,e){if(e.file!==k){return}e.transport&&e.transport.send();k.setStatus(d.PROGRESS)})}else {if(k.getStatus()!==d.PROGRESS){k.setStatus(d.QUEUED)}}}else {e.each(g.request('get-files',[d.INITED]),function(){this.setStatus(d.QUEUED)})}if(g.runing){g.owner.trigger('startUpload',k);return f.nextTick(g.__tick)}g.runing=!0;var l=[];k||e.each(g.pool,function(n,e){var m=e.file;if(m.getStatus()===d.INTERRUPT){g._trigged=!1;l.push(m);if(e.waiting){return}e.transport?e.transport.send():g._doSend(e)}});e.each(l,function(){this.setStatus(d.PROGRESS)});k||e.each(g.request('get-files',d.INTERRUPT),function(){this.setStatus(d.PROGRESS)});g._trigged=!1;f.nextTick(g.__tick);g.owner.trigger('startUpload')},stopUpload:function(g,l){var k=this;if(g===!0){l=g;g=null}if(k.runing===!1){return}if(g){g=g.id?g:k.request('get-file',g);if(g.getStatus()!==d.PROGRESS&&g.getStatus()!==d.QUEUED){return}g.setStatus(d.INTERRUPT);e.each(k.pool,function(e,d){if(d.file===g){d.transport&&d.transport.abort();if(l){k._putback(d);k._popBlock(d)}}});k.owner.trigger('stopUpload',g);return f.nextTick(k.__tick)}k.runing=!1;if(this._promise&&this._promise.file){this._promise.file.setStatus(d.INTERRUPT)}l&&e.each(k.pool,function(k,e){e.transport&&e.transport.abort();e.file.setStatus(d.INTERRUPT)});k.owner.trigger('stopUpload')},cancelFile:function(g){g=g.id?g:this.request('get-file',g);g.blocks&&e.each(g.blocks,function(k,e){var d=e.transport;if(d){d.abort();d.destroy();delete e.transport}});g.setStatus(d.CANCELLED);this.owner.trigger('fileDequeued',g)},isInProgress:function(){return !!this.progress},_getStats:function(){return this.request('get-stats')},skipFile:function(g,k){g=g.id?g:this.request('get-file',g);g.setStatus(k||d.COMPLETE);g.skipped=!0;g.blocks&&e.each(g.blocks,function(l,e){var d=e.transport;if(d){d.abort();d.destroy();delete e.transport}});this.owner.trigger('uploadSkip',g)},_tick:function(){var d=this,l=d.options,k,e;if(d._promise){return d._promise.always(d.__tick)}if(d.pool.length<l.threads&&(e=d._nextBlock())){d._trigged=!1;k=function(e){d._promise=null;e&&e.file&&d._startSend(e);f.nextTick(d.__tick)};d._promise=g(e)?e.always(k):k(e)}else {if(!d.remaning&&!d._getStats().numOfQueue&&!d._getStats().numOfInterrupt){d.runing=!1;d._trigged||f.nextTick(function(){d.owner.trigger('uploadFinished')});d._trigged=!0}}},_putback:function(d){var e;d.cuted.unshift(d);e=this.stack.indexOf(d.cuted);if(!~e){this.remaning++;d.file.remaning++;this.stack.unshift(d.cuted)}},_getStack:function(){var g=0,e;while(e=this.stack[g++]){if(e.has()&&e.file.getStatus()===d.PROGRESS){return e}else {if(!e.has()||e.file.getStatus()!==d.PROGRESS&&e.file.getStatus()!==d.INTERRUPT){this.stack.splice(--g,1)}}}return null},_nextBlock:function(){var e=this,m=e.options,k,d,l,n;if(k=this._getStack()){if(m.prepareNextFile&&!e.pending.length){e._prepareNextFile()}return k.shift()}else {if(e.runing){if(!e.pending.length&&e._getStats().numOfQueue){e._prepareNextFile()}d=e.pending.shift();l=function(d){if(!d){return null}k=CuteFile(d,m.chunked?m.chunkSize:0);e.stack.push(k);return k.shift()};if(g(d)){n=d.file;d=d[d.pipe?'pipe':'then'](l);d.file=n;return d}return l(d)}}},_prepareNextFile:function(){var k=this,g=k.request('fetch-file'),m=k.pending,l;if(g){l=k.request('before-send-file',g,function(){if(g.getStatus()===d.PROGRESS||g.getStatus()===d.INTERRUPT){return g}return k._finishFile(g)});k.owner.trigger('uploadStart',g);g.setStatus(d.PROGRESS);l.file=g;l.done(function(){var d=e.inArray(l,m);~d&&m.splice(d,1,g)});l.fail(function(e){g.setStatus(d.ERROR,e);k.owner.trigger('uploadError',g,e);k.owner.trigger('uploadComplete',g)});m.push(l)}},_popBlock:function(d){var g=e.inArray(d,this.pool);this.pool.splice(g,1);d.file.remaning--;this.remaning--},_startSend:function(e){var g=this,k=e.file,l;if(k.getStatus()!==d.PROGRESS){if(k.getStatus()===d.INTERRUPT){g._putback(e)}return}g.pool.push(e);g.remaning++;e.blob=e.chunks===1?k.source:k.source.slice(e.start,e.end);e.waiting=l=g.request('before-send',e,function(){delete e.waiting;if(k.getStatus()===d.PROGRESS){g._doSend(e)}else {if(e.file.getStatus()!==d.INTERRUPT){g._popBlock(e)}}f.nextTick(g.__tick)});l.fail(function(){delete e.waiting;if(k.remaning===1){g._finishFile(k).always(function(){e.percentage=1;g._popBlock(e);g.owner.trigger('uploadComplete',k);f.nextTick(g.__tick)})}else {e.percentage=1;g.updateFileProgress(k);g._popBlock(e);f.nextTick(g.__tick)}})},_doSend:function(g){var m=this,q=m.owner,n=e.extend({},m.options,g.options),l=g.file,k=new i(n),p=e.extend({},n.formData),s=e.extend({},n.headers),r,o;g.transport=k;k.on('destroy',function(){delete g.transport;m._popBlock(g);f.nextTick(m.__tick)});k.on('progress',function(d){g.percentage=d;m.updateFileProgress(l)});r=function(d){var e;o=k.getResponseAsJson()||{};o._raw=k.getResponse();o._headers=k.getResponseHeaders();g.response=o;e=function(e){d=e};if(!q.trigger('uploadAccept',g,o,e)){d=d||'server'}return d};k.on('error',function(e,t){var o=e.split('|'),s,p;e=o[0];s=parseFloat(o[1]),p=o[2];g.retried=g.retried||0;if(g.chunks>1&&~'http,abort,server'.indexOf(e.replace(/-.*/,''))&&g.retried<n.chunkRetry){g.retried++;m.retryTimer=setTimeout(function(){k.send()},n.chunkRetryDelay||1000)}else {if(!t&&e==='server'){e=r(e)}l.setStatus(d.ERROR,e);q.trigger('uploadError',l,e,s,p);q.trigger('uploadComplete',l)}});k.on('load',function(){var d;if(d=r()){k.trigger('error',d,!0);return}if(l.remaning===1){m._finishFile(l,o)}else {k.destroy()}});p=e.extend(p,{id:l.id,name:l.name,type:l.type,lastModifiedDate:l.lastModifiedDate,size:l.size});g.chunks>1&&e.extend(p,{chunks:g.chunks,chunk:g.chunk});q.trigger('uploadBeforeSend',g,p,s);k.appendBlob(n.fileVal,g.blob,l.name);k.append(p);k.setRequestHeader(s);k.send()},_finishFile:function(e,l,k){var g=this.owner;return g.request('after-send-file',arguments,function(){e.setStatus(d.COMPLETE);g.trigger('uploadSuccess',e,l,k)}).fail(function(m){if(e.getStatus()===d.PROGRESS){e.setStatus(d.ERROR,m)}g.trigger('uploadError',e,m)}).always(function(){g.trigger('uploadComplete',e)})},updateFileProgress:function(d){var g=0,k=0;if(!d.blocks){return}e.each(d.blocks,function(g,e){k+=(e.percentage||0)*(e.end-e.start)});g=k/d.size;this.owner.trigger('uploadProgress',d,g||0)},destroy:function(){clearTimeout(this.retryTimer)}})});a('widgets/validator',['base','uploader','file','widgets/widget'],function(f,g,h){var i=f.$,e={},d;d={addValidator:function(d,i){e[d]=i},removeValidator:function(d){delete e[d]}};g.register({name:'validator',init:function(){var d=this;f.nextTick(function(){i.each(e,function(){this.call(d.owner)})})}});d.addValidator('fileNumLimit',function(){var e=this,k=e.options,d=0,i=parseInt(k.fileNumLimit,10),j=!0;if(!i){return}e.on('beforeFileQueued',function(e){if(!this.trigger('beforeFileQueuedCheckfileNumLimit',e,d)){return !1}if(d>=i&&j){j=!1;this.trigger('error','Q_EXCEED_NUM_LIMIT',i,e);setTimeout(function(){j=!0},1)}return d>=i?!1:!0});e.on('fileQueued',function(){d++});e.on('fileDequeued',function(){d--});e.on('reset',function(){d=0})});d.addValidator('fileSizeLimit',function(){var d=this,k=d.options,e=0,j=parseInt(k.fileSizeLimit,10),i=!0;if(!j){return}d.on('beforeFileQueued',function(k){var d=e+k.size>j;if(d&&i){i=!1;this.trigger('error','Q_EXCEED_SIZE_LIMIT',j,k);setTimeout(function(){i=!0},1)}return d?!1:!0});d.on('fileQueued',function(d){e+=d.size});d.on('fileDequeued',function(d){e-=d.size});d.on('reset',function(){e=0})});d.addValidator('fileSingleSizeLimit',function(){var e=this,i=e.options,d=i.fileSingleSizeLimit;if(!d){return}e.on('beforeFileQueued',function(e){if(e.size>d){e.setStatus(h.Status.INVALID,'exceed_size');this.trigger('error','F_EXCEED_SIZE',d,e);return !1}})});d.addValidator('duplicate',function(){var d=this,i=d.options,e={};if(i.duplicate){return}function hashString(j){var d=0,e=0,k=j.length,i;for(;e<k;e++){i=j.charCodeAt(e);d=i+(d<<6)+(d<<16)-d}return d}d.on('beforeFileQueued',function(d){var i=d.__hash||(d.__hash=hashString(d.name+d.size+d.lastModifiedDate));if(e[i]){this.trigger('error','F_DUPLICATE',d);return !1}});d.on('fileQueued',function(i){var d=i.__hash;d&&(e[d]=!0)});d.on('fileDequeued',function(i){var d=i.__hash;d&&delete e[d]});d.on('reset',function(){e={}})});return d});a('lib/md5',['runtime/client','mediator'],function(d,e){function Md5(){d.call(this,'Md5')}e.installTo(Md5.prototype);Md5.prototype.loadFromBlob=function(g){var f=this;if(f.getRuid()){f.disconnectRuntime()}f.connectRuntime(g.ruid,function(){f.exec('init');f.exec('loadFromBlob',g)})};Md5.prototype.getResult=function(){return this.exec('getResult')};return Md5});a('widgets/md5',['base','uploader','lib/md5','lib/blob','widgets/widget'],function(e,d,g,f){return d.register({name:'md5',md5File:function(m,i,h){var k=new g(),l=e.Deferred(),j=m instanceof f?m:this.request('get-file',m).source;k.on('progress load',function(j){j=j||{};l.notify(j.total?j.loaded/j.total:1)});k.on('complete',function(){l.resolve(k.getResult())});k.on('error',function(j){l.reject(j)});if(arguments.length>1){i=i||0;h=h||0;i<0&&(i=j.size+i);h<0&&(h=j.size+h);h=Math.min(h,j.size);j=j.slice(i,h)}k.loadFromBlob(j);return l.promise()}})});a('runtime/compbase',[],function(){function CompBase(d,e){this.owner=d;this.options=d.options;this.getRuntime=function(){return e};this.getRuid=function(){return e.uid};this.trigger=function(){return d.trigger.apply(d,arguments)}}return CompBase});a('runtime/html5/runtime',['base','runtime/runtime','runtime/compbase'],function(f,e,h){var g='html5',d={};function Html5Runtime(){var k={},i=this,j=this.destroy;e.apply(i,arguments);i.type=g;i.exec=function(l,n){var j=this,m=j.uid,o=f.slice(arguments,2),g;if(d[l]){g=k[m]=k[m]||new d[l](j,i);if(g[n]){return g[n].apply(g,o)}}};i.destroy=function(){return j&&j.apply(this,arguments)}}f.inherits(e,{constructor:Html5Runtime,init:function(){var d=this;setTimeout(function(){d.trigger('ready')},1)}});Html5Runtime.register=function(j,g){var i=d[j]=f.inherits(h,g);return i};if(b.Blob&&b.FileReader&&b.DataView){e.addRuntime(g,Html5Runtime)}return Html5Runtime});a('runtime/html5/blob',['runtime/html5/runtime','lib/blob'],function(d,e){return d.register('Blob',{slice:function(h,i){var f=this.owner.source,g=f.slice||f.webkitSlice||f.mozSlice;f=g.call(f,h,i);return new e(this.getRuid(),f)}})});a('runtime/html5/dnd',['base','runtime/html5/runtime','lib/file'],function(d,g,h){var e=d.$,f='webuploader-dnd-';return g.register('DragAndDrop',{init:function(){var f=this.elem=this.options.container;this.dragEnterHandler=d.bindFn(this._dragEnterHandler,this);this.dragOverHandler=d.bindFn(this._dragOverHandler,this);this.dragLeaveHandler=d.bindFn(this._dragLeaveHandler,this);this.dropHandler=d.bindFn(this._dropHandler,this);this.dndOver=!1;f.on('dragenter',this.dragEnterHandler);f.on('dragover',this.dragOverHandler);f.on('dragleave',this.dragLeaveHandler);f.on('drop',this.dropHandler);if(this.options.disableGlobalDnd){e(document).on('dragover',this.dragOverHandler);e(document).on('drop',this.dropHandler)}},_dragEnterHandler:function(i){var e=this,k=e._denied||!1,j;i=i.originalEvent||i;if(!e.dndOver){e.dndOver=!0;j=i.dataTransfer.items;if(j&&j.length){e._denied=k=!e.trigger('accept',j)}e.elem.addClass(f+'over');e.elem[k?'addClass':'removeClass'](f+'denied')}i.dataTransfer.dropEffect=k?'none':'copy';return !1},_dragOverHandler:function(i){var f=this.elem.parent().get(0);if(f&&!e.contains(f,i.currentTarget)){return !1}clearTimeout(this._leaveTimer);this._dragEnterHandler.call(this,i);return !1},_dragLeaveHandler:function(){var e=this,i;i=function(){e.dndOver=!1;e.elem.removeClass(f+'over '+f+'denied')};clearTimeout(e._leaveTimer);e._leaveTimer=setTimeout(i,100);return !1},_dropHandler:function(j){var i=this,n=i.getRuid(),l=i.elem.parent().get(0),k,m;if(l&&!e.contains(l,j.currentTarget)){return !1}j=j.originalEvent||j;k=j.dataTransfer;try{m=k.getData('text/html')}catch(o){}i.dndOver=!1;i.elem.removeClass(f+'over');if(!k||m){return}i._getTansferFiles(k,function(f){i.trigger('drop',e.map(f,function(e){return new h(n,e)}))});return !1},_getTansferFiles:function(m,q){var i=[],n=[],e,j,o,k,f,p,l;e=m.items;j=m.files;l=!!(e&&e[0].webkitGetAsEntry);for(f=0,p=j.length;f<p;f++){o=j[f];k=e&&e[f];if(l&&k.webkitGetAsEntry().isDirectory){n.push(this._traverseDirectoryTree(k.webkitGetAsEntry(),i))}else {i.push(o)}}d.when.apply(d,n).done(function(){if(!i.length){return}q(i)})},_traverseDirectoryTree:function(f,i){var e=d.Deferred(),j=this;if(f.isFile){f.file(function(j){i.push(j);e.resolve()})}else {if(f.isDirectory){f.createReader().readEntries(function(m){var o=m.length,l=[],n=[],k;for(k=0;k<o;k++){l.push(j._traverseDirectoryTree(m[k],n))}d.when.apply(d,l).then(function(){i.push.apply(i,n);e.resolve()},e.reject)})}}return e.promise()},destroy:function(){var f=this.elem;if(!f){return}f.off('dragenter',this.dragEnterHandler);f.off('dragover',this.dragOverHandler);f.off('dragleave',this.dragLeaveHandler);f.off('drop',this.dropHandler);if(this.options.disableGlobalDnd){e(document).off('dragover',this.dragOverHandler);e(document).off('drop',this.dropHandler)}}})});a('runtime/html5/filepaste',['base','runtime/html5/runtime','lib/file'],function(e,d,f){return d.register('FilePaste',{init:function(){var h=this.options,m=this.elem=h.container,g='.*',i,j,l,k;if(h.accept){i=[];for(j=0,l=h.accept.length;j<l;j++){k=h.accept[j].mimeTypes;k&&i.push(k)}if(i.length){g=i.join(',');g=g.replace(/,/g,'|').replace(/\*/g,'.*')}}this.accept=g=new RegExp(g,'i');this.hander=e.bindFn(this._pasteHander,this);m.on('paste',this.hander)},_pasteHander:function(g){var i=[],n=this.getRuid(),j,k,l,h,m;g=g.originalEvent||g;j=g.clipboardData.items;for(h=0,m=j.length;h<m;h++){k=j[h];if(k.kind!=='file'||!(l=k.getAsFile())){continue}i.push(new f(n,l))}if(i.length){g.preventDefault();g.stopPropagation();this.trigger('paste',i)}},destroy:function(){this.elem.off('paste',this.hander)}})});a('runtime/html5/filepicker',['base','runtime/html5/runtime'],function(f,e){var d=f.$;return e.register('FilePicker',{init:function(){var p=this.getRuntime().getContainer(),o=this,m=o.owner,h=o.options,i=this.label=d(document.createElement('label')),g=this.input=d(document.createElement('input')),n,j,q,l,k;g.attr('type','file');g.attr('capture','camera');g.attr('name',h.name);g.addClass('webuploader-element-invisible');i.on('click',function(d){g.trigger('click');d.stopPropagation();m.trigger('dialogopen')});i.css({opacity:0,width:'100%',height:'100%',display:'block',cursor:'pointer',background:'#ffffff'});if(h.multiple){g.attr('multiple','multiple')}if(h.accept&&h.accept.length>0){n=[];for(j=0,q=h.accept.length;j<q;j++){n.push(h.accept[j].mimeTypes)}g.attr('accept',n.join(','))}p.append(g);p.append(i);l=function(d){m.trigger(d.type)};k=function(i){var h;if(i.target.files.length===0){return !1}o.files=i.target.files;h=this.cloneNode(!0);h.value=null;this.parentNode.replaceChild(h,this);g.off();g=d(h).on('change',k).on('mouseenter mouseleave',l);m.trigger('change')};g.on('change',k);i.on('mouseenter mouseleave',l)},getFiles:function(){return this.files},destroy:function(){this.input.off();this.label.off()}})});a('runtime/html5/util',['base'],function(g){var d=b.createObjectURL&&b||b.URL&&URL.revokeObjectURL&&URL||b.webkitURL,e=g.noop,f=e;if(d){e=function(){return d.createObjectURL.apply(d,arguments)};f=function(){return d.revokeObjectURL.apply(d,arguments)}}return {createObjectURL:e,revokeObjectURL:f,dataURL2Blob:function(k){var d,i,h,f,j,e;e=k.split(',');if(~e[0].indexOf('base64')){d=atob(e[1])}else {d=decodeURIComponent(e[1])}h=new ArrayBuffer(d.length);i=new Uint8Array(h);for(f=0;f<d.length;f++){i[f]=d.charCodeAt(f)}j=e[0].split(':')[1].split(';')[0];return this.arrayBufferToBlob(h,j)},dataURL2ArrayBuffer:function(i){var d,h,e,f;f=i.split(',');if(~f[0].indexOf('base64')){d=atob(f[1])}else {d=decodeURIComponent(f[1])}h=new Uint8Array(d.length);for(e=0;e<d.length;e++){h[e]=d.charCodeAt(e)}return h.buffer},arrayBufferToBlob:function(h,d){var f=b.BlobBuilder||b.WebKitBlobBuilder,e;if(f){e=new f();e.append(h);return e.getBlob(d)}return new Blob([h],d?{type:d}:{})},canvasToDataUrl:function(e,f,d){return e.toDataURL(f,d/100)},parseMeta:function(e,d){d(!1,{})},updateImageHead:function(d){return d}}});a('runtime/html5/imagemeta',['runtime/html5/util'],function(e){var d;d={parsers:{65505:[]},maxMetaDataSize:262144,parse:function(f,g){var h=this,d=new FileReader();d.onload=function(){g(!1,h._parse(this.result));d=d.onload=d.onerror=null};d.onerror=function(h){g(h.message);d=d.onload=d.onerror=null};f=f.slice(0,h.maxMetaDataSize);d.readAsArrayBuffer(f.getSource())},_parse:function(i,p){if(i.byteLength<6){return}var g=new DataView(i),f=2,o=g.byteLength-4,k=f,m={},h,j,l,n;if(g.getUint16(0)===65496){while(f<o){h=g.getUint16(f);if(h>=65504&&h<=65519||h===65534){j=g.getUint16(f+2)+2;if(f+j>g.byteLength){break}l=d.parsers[h];if(!p&&l){for(n=0;n<l.length;n+=1){l[n].call(d,g,f,j,m)}}f+=j;k=f}else {break}}if(k>6){if(i.slice){m.imageHead=i.slice(2,k)}else {m.imageHead=(new Uint8Array(i)).subarray(2,k)}}}return m},updateImageHead:function(g,i){var j=this._parse(g,!0),d,h,f;f=2;if(j.imageHead){f=2+j.imageHead.byteLength}if(g.slice){h=g.slice(f)}else {h=(new Uint8Array(g)).subarray(f)}d=new Uint8Array(i.byteLength+2+h.byteLength);d[0]=255;d[1]=216;d.set(new Uint8Array(i),2);d.set(new Uint8Array(h),i.byteLength+2);return d.buffer}};e.parseMeta=function(){return d.parse.apply(d,arguments)};e.updateImageHead=function(){return d.updateImageHead.apply(d,arguments)};return d});a('runtime/html5/imagemeta/exif',['base','runtime/html5/imagemeta'],function(e,f){var d={};d.ExifMap=function(){return this};d.ExifMap.prototype.map={'Orientation':274};d.ExifMap.prototype.get=function(d){return this[d]||this[this.map[d]]};d.exifTagTypes={1:{getValue:function(g,d){return g.getUint8(d)},size:1},2:{getValue:function(g,d){return String.fromCharCode(g.getUint8(d))},size:1,ascii:!0},3:{getValue:function(h,g,d){return h.getUint16(g,d)},size:2},4:{getValue:function(h,g,d){return h.getUint32(g,d)},size:4},5:{getValue:function(h,g,d){return h.getUint32(g,d)/h.getUint32(g+4,d)},size:8},9:{getValue:function(h,g,d){return h.getInt32(g,d)},size:4},10:{getValue:function(h,g,d){return h.getInt32(g,d)/h.getInt32(g+4,d)},size:8}};d.exifTagTypes[7]=d.exifTagTypes[1];d.getExifValue=function(k,r,q,s,n,l){var h=d.exifTagTypes[s],m,j,i,g,o,p;if(!h){e.log('Invalid Exif data: Invalid tag type.');return}m=h.size*n;j=m>4?r+k.getUint32(q+8,l):q+8;if(j+m>k.byteLength){e.log('Invalid Exif data: Invalid data offset.');return}if(n===1){return h.getValue(k,j,l)}i=[];for(g=0;g<n;g+=1){i[g]=h.getValue(k,j+g*h.size,l)}if(h.ascii){o='';for(g=0;g<i.length;g+=1){p=i[g];if(p==='\x00'){break}o+=p}return o}return i};d.parseExifTag=function(h,j,i,g,k){var l=h.getUint16(i,g);k.exif[l]=d.getExifValue(h,j,i,h.getUint16(i+2,g),h.getUint32(i+4,g),g)};d.parseExifTags=function(d,l,g,j,m){var k,i,h;if(g+6>d.byteLength){e.log('Invalid Exif data: Invalid directory offset.');return}k=d.getUint16(g,j);i=g+2+12*k;if(i+4>d.byteLength){e.log('Invalid Exif data: Invalid directory size.');return}for(h=0;h<k;h+=1){this.parseExifTag(d,l,g+2+12*h,j,m)}return d.getUint32(i,j)};d.parseExifData=function(g,k,m,l){var h=k+10,i,j;if(g.getUint32(k+4)!==1165519206){return}if(h+8>g.byteLength){e.log('Invalid Exif data: Invalid segment size.');return}if(g.getUint16(k+8)!==0){e.log('Invalid Exif data: Missing byte alignment offset.');return}switch(g.getUint16(h)){case 18761:i=!0;break;case 19789:i=!1;break;default:e.log('Invalid Exif data: Invalid byte alignment marker.');return;}if(g.getUint16(h+2,i)!==42){e.log('Invalid Exif data: Missing TIFF marker.');return}j=g.getUint32(h+4,i);l.exif=new d.ExifMap();j=d.parseExifTags(g,h,h+j,i,l)};f.parsers[65505].push(d.parseExifData);return d});a('runtime/html5/jpegencoder',[],function(e,d,f){function JPEGEncoder(s){var N=this;var M=Math.round;var H=Math.floor;var t=new Array(64);var r=new Array(64);var E=new Array(64);var o=new Array(64);var G;var q;var F;var p;var i=new Array(65535);var m=new Array(65535);var C=new Array(64);var k=new Array(64);var n=[];var j=0;var h=7;var K=new Array(64);var I=new Array(64);var J=new Array(64);var L=new Array(256);var g=new Array(2048);var D;var l=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63];var z=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];var B=[0,1,2,3,4,5,6,7,8,9,10,11];var y=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125];var A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250];var v=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];var x=[0,1,2,3,4,5,6,7,8,9,10,11];var u=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119];var w=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function initQuantTables(q){var v=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99];for(var n=0;n<64;n++){var h=H((v[n]*q+50)/100);if(h<1){h=1}else {if(h>255){h=255}}t[l[n]]=h}var u=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(var p=0;p<64;p++){var i=H((u[p]*q+50)/100);if(i<1){i=1}else {if(i>255){i=255}}r[l[p]]=i}var j=[1,1.387039845,1.306562965,1.175875602,1,0.785694958,0.5411961,0.275899379];var g=0;for(var m=0;m<8;m++){for(var k=0;k<8;k++){E[g]=1/(t[l[g]]*j[m]*j[k]*8);o[g]=1/(r[l[g]]*j[m]*j[k]*8);g++}}}function computeHuffmanTbl(m,k){var j=0;var g=0;var h=new Array();for(var i=1;i<=16;i++){for(var l=1;l<=m[i];l++){h[k[g]]=[];h[k[g]][0]=j;h[k[g]][1]=i;g++;j++}j*=2}return h}function initHuffmanTbl(){G=computeHuffmanTbl(z,B);q=computeHuffmanTbl(v,x);F=computeHuffmanTbl(y,A);p=computeHuffmanTbl(u,w)}function initCategoryNumber(){var l=1;var k=2;for(var j=1;j<=15;j++){for(var h=l;h<k;h++){m[32767+h]=j;i[32767+h]=[];i[32767+h][1]=j;i[32767+h][0]=h}for(var g=-(k-1);g<=-l;g++){m[32767+g]=j;i[32767+g]=[];i[32767+g][1]=j;i[32767+g][0]=k-1+g}l<<=1;k<<=1}}function initRGBYUVTable(){for(var h=0;h<256;h++){g[h]=19595*h;g[h+256>>0]=38470*h;g[h+512>>0]=7471*h+32768;g[h+768>>0]=-11059*h;g[h+1024>>0]=-21709*h;g[h+1280>>0]=32768*h+8421375;g[h+1536>>0]=-27439*h;g[h+1792>>0]=-5329*h}}function writeBits(i){var k=i[0];var g=i[1]-1;while(g>=0){if(k&1<<g){j|=1<<h}g--;h--;if(h<0){if(j==255){writeByte(255);writeByte(0)}else {writeByte(j)}h=7;j=0}}}function writeByte(g){n.push(L[g])}function writeWord(g){writeByte(g>>8&255);writeByte(g&255)}function fDCTQuant(h,ae){var j,k,l,m,n,o,p,q;var g=0;var i;var Z=8;var ag=64;for(i=0;i<Z;++i){j=h[g];k=h[g+1];l=h[g+2];m=h[g+3];n=h[g+4];o=h[g+5];p=h[g+6];q=h[g+7];var M=j+q;var D=j-q;var N=k+p;var R=k-p;var O=l+o;var Q=l-o;var P=m+n;var af=m-n;var t=M+P;var B=M-P;var x=N+O;var y=N-O;h[g]=t+x;h[g+4]=t-x;var $=(y+B)*0.707106781;h[g+2]=B+$;h[g+6]=B-$;t=af+Q;x=Q+R;y=R+D;var ac=(t-y)*0.382683433;var _=0.5411961*t+ac;var ab=1.306562965*y+ac;var aa=x*0.707106781;var X=D+aa;var Y=D-aa;h[g+5]=Y+_;h[g+3]=Y-_;h[g+1]=X+ab;h[g+7]=X-ab;g+=8}g=0;for(i=0;i<Z;++i){j=h[g];k=h[g+8];l=h[g+16];m=h[g+24];n=h[g+32];o=h[g+40];p=h[g+48];q=h[g+56];var E=j+q;var A=j-q;var F=k+p;var J=k-p;var G=l+o;var I=l-o;var H=m+n;var ad=m-n;var r=E+H;var z=E-H;var v=F+G;var w=F-G;h[g]=r+v;h[g+32]=r-v;var S=(w+z)*0.707106781;h[g+16]=z+S;h[g+48]=z-S;r=ad+I;v=I+J;w=J+A;var W=(r-w)*0.382683433;var T=0.5411961*r+W;var V=1.306562965*w+W;var U=v*0.707106781;var K=A+U;var L=A-U;h[g+40]=L+T;h[g+24]=L-T;h[g+8]=K+V;h[g+56]=K-V;g++}var u;for(i=0;i<ag;++i){u=h[i]*ae[i];C[i]=u>0?u+0.5|0:u-0.5|0}return C}function writeAPP0(){writeWord(65504);writeWord(16);writeByte(74);writeByte(70);writeByte(73);writeByte(70);writeByte(0);writeByte(1);writeByte(1);writeByte(0);writeWord(1);writeWord(1);writeByte(0);writeByte(0)}function writeSOF0(h,g){writeWord(65472);writeWord(17);writeByte(8);writeWord(g);writeWord(h);writeByte(3);writeByte(1);writeByte(17);writeByte(0);writeByte(2);writeByte(17);writeByte(1);writeByte(3);writeByte(17);writeByte(1)}function writeDQT(){writeWord(65499);writeWord(132);writeByte(0);for(var g=0;g<64;g++){writeByte(t[g])}writeByte(1);for(var h=0;h<64;h++){writeByte(r[h])}}function writeDHT(){writeWord(65476);writeWord(418);writeByte(0);for(var g=0;g<16;g++){writeByte(z[g+1])}for(var h=0;h<=11;h++){writeByte(B[h])}writeByte(16);for(var i=0;i<16;i++){writeByte(y[i+1])}for(var j=0;j<=161;j++){writeByte(A[j])}writeByte(1);for(var k=0;k<16;k++){writeByte(v[k+1])}for(var l=0;l<=11;l++){writeByte(x[l])}writeByte(17);for(var m=0;m<16;m++){writeByte(u[m+1])}for(var n=0;n<=161;n++){writeByte(w[n])}}function writeSOS(){writeWord(65498);writeWord(12);writeByte(3);writeByte(1);writeByte(0);writeByte(2);writeByte(17);writeByte(3);writeByte(17);writeByte(0);writeByte(63);writeByte(0)}function processDU(B,A,o,u,q){var v=q[0];var x=q[240];var j;var C=16;var D=63;var E=64;var z=fDCTQuant(B,A);for(var p=0;p<E;++p){k[l[p]]=z[p]}var t=k[0]-o;o=k[0];if(t==0){writeBits(u[0])}else {j=32767+t;writeBits(u[m[j]]);writeBits(i[j])}var h=63;for(;h>0&&k[h]==0;h--){}if(h==0){writeBits(v);return o}var g=1;var w;while(g<=h){var y=g;for(;k[g]==0&&g<=h;++g){}var n=g-y;if(n>=C){w=n>>4;for(var r=1;r<=w;++r){writeBits(x)}n=n&15}j=32767+k[g];writeBits(q[(n<<4)+m[j]]);writeBits(i[j]);g++}if(h!=D){writeBits(v)}return o}function initCharLookupTable(){var h=String.fromCharCode;for(var g=0;g<256;g++){L[g]=h(g)}}this.encode=function(r,D){if(D){setQuality(D)}n=new Array();j=0;h=7;writeWord(65496);writeAPP0();writeDQT();writeSOF0(r.width,r.height);writeDHT();writeSOS();var N=0;var L=0;var M=0;j=0;h=7;this.encode.displayName='_encode_';var z=r.data;var H=r.width;var B=r.height;var l=H*4;var P=H*3;var m,v=0;var y,x,w;var C,k,t,u,i;while(v<B){m=0;while(m<l){C=l*v+m;k=C;t=-1;u=0;for(i=0;i<64;i++){u=i>>3;t=(i&7)*4;k=C+u*l+t;if(v+u>=B){k-=l*(v+1+u-B)}if(m+t>=l){k-=m+t-l+4}y=z[k++];x=z[k++];w=z[k++];K[i]=(g[y]+g[x+256>>0]+g[w+512>>0]>>16)-128;I[i]=(g[y+768>>0]+g[x+1024>>0]+g[w+1280>>0]>>16)-128;J[i]=(g[y+1280>>0]+g[x+1536>>0]+g[w+1792>>0]>>16)-128}N=processDU(K,E,N,G,F);L=processDU(I,o,L,q,p);M=processDU(J,o,M,q,p);m+=32}v+=8}if(h>=0){var A=[];A[1]=h+1;A[0]=(1<<h+1)-1;writeBits(A)}writeWord(65497);var O='data:image/jpeg;base64,'+btoa(n.join(''));n=[];return O};function setQuality(g){if(g<=0){g=1}if(g>100){g=100}if(D==g){return}var h=0;if(g<50){h=Math.floor(5000/g)}else {h=Math.floor(200-g*2)}initQuantTables(h);D=g}function init(){if(!s){s=50}initCharLookupTable();initHuffmanTbl();initCategoryNumber();initRGBYUVTable();setQuality(s)}init()}JPEGEncoder.encode=function(i,h){var g=new JPEGEncoder(h);return g.encode(i)};return JPEGEncoder});a('runtime/html5/androidpatch',['runtime/html5/util','runtime/html5/jpegencoder','base'],function(f,g,h){var e=f.canvasToDataUrl,d;f.canvasToDataUrl=function(k,l,p){var m,o,n,i,j;if(!h.os.android){return e.apply(null,arguments)}if(l==='image/jpeg'&&typeof d==='undefined'){i=e.apply(null,arguments);j=i.split(',');if(~j[0].indexOf('base64')){i=atob(j[1])}else {i=decodeURIComponent(j[1])}i=i.substring(0,2);d=i.charCodeAt(0)===255&&i.charCodeAt(1)===216}if(l==='image/jpeg'&&!d){o=k.width;n=k.height;m=k.getContext('2d');return g.encode(m.getImageData(0,0,o,n),p)}return e.apply(null,arguments)}});a('runtime/html5/image',['base','runtime/html5/runtime','runtime/html5/util'],function(e,f,d){var g='data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D';return f.register('Image',{modified:!1,init:function(){var g=this,h=new Image();h.onload=function(){g._info={type:g.type,width:this.width,height:this.height};if(!g._metas&&'image/jpeg'===g.type){d.parseMeta(g._blob,function(i,h){g._metas=h;g.owner.trigger('load')})}else {g.owner.trigger('load')}};h.onerror=function(){g.owner.trigger('error')};g._img=h},loadFromBlob:function(h){var g=this,i=g._img;g._blob=h;g.type=h.type;i.src=d.createObjectURL(h.getSource());g.owner.once('load',function(){d.revokeObjectURL(i.src)})},resize:function(i,h){var g=this._canvas||(this._canvas=document.createElement('canvas'));this._resize(this._img,g,i,h);this._blob=null;this.modified=!0;this.owner.trigger('complete','resize')},crop:function(p,q,o,n,h){var g=this._canvas||(this._canvas=document.createElement('canvas')),k=this.options,i=this._img,m=i.naturalWidth,l=i.naturalHeight,j=this.getOrientation();h=h||1;g.width=o;g.height=n;k.preserveHeaders||this._rotate2Orientaion(g,j);this._renderImageToCanvas(g,i,-p,-q,m*h,l*h);this._blob=null;this.modified=!0;this.owner.trigger('complete','crop')},getAsBlob:function(h){var g=this._blob,j=this.options,i;h=h||this.type;if(this.modified||this.type!==h){i=this._canvas;if(h==='image/jpeg'){g=d.canvasToDataUrl(i,h,j.quality);if(j.preserveHeaders&&this._metas&&this._metas.imageHead){g=d.dataURL2ArrayBuffer(g);g=d.updateImageHead(g,this._metas.imageHead);g=d.arrayBufferToBlob(g,h);return g}}else {g=d.canvasToDataUrl(i,h)}g=d.dataURL2Blob(g)}return g},getAsDataUrl:function(g){var h=this.options;g=g||this.type;if(g==='image/jpeg'){return d.canvasToDataUrl(this._canvas,g,h.quality)}else {return this._canvas.toDataURL(g)}},getOrientation:function(){return this._metas&&this._metas.exif&&this._metas.exif.get('Orientation')||1},info:function(g){if(g){this._info=g;return this}return this._info},meta:function(g){if(g){this._metas=g;return this}return this._metas},destroy:function(){var h=this._canvas;this._img.onload=null;if(h){h.getContext('2d').clearRect(0,0,h.width,h.height);h.width=h.height=0;this._canvas=null}this._img.src=g;this._img=this._blob=null},_resize:function(n,g,j,h){var k=this.options,p=n.width,o=n.height,q=this.getOrientation(),i,m,l,r,s;if(~[5,6,7,8].indexOf(q)){j^=h;h^=j;j^=h}i=Math[k.crop?'max':'min'](j/p,h/o);k.allowMagnify||(i=Math.min(1,i));m=p*i;l=o*i;if(k.crop){g.width=j;g.height=h}else {g.width=m;g.height=l}r=(g.width-m)/2;s=(g.height-l)/2;k.preserveHeaders||this._rotate2Orientaion(g,q);this._renderImageToCanvas(g,n,r,s,m,l)},_rotate2Orientaion:function(h,k){var j=h.width,i=h.height,g=h.getContext('2d');switch(k){case 5:case 6:case 7:case 8:h.width=i;h.height=j;break;}switch(k){case 2:g.translate(j,0);g.scale(-1,1);break;case 3:g.translate(j,i);g.rotate(Math.PI);break;case 4:g.translate(0,i);g.scale(1,-1);break;case 5:g.rotate(0.5*Math.PI);g.scale(1,-1);break;case 6:g.rotate(0.5*Math.PI);g.translate(0,-i);break;case 7:g.rotate(0.5*Math.PI);g.translate(j,-i);g.scale(-1,1);break;case 8:g.rotate(-0.5*Math.PI);g.translate(-j,0);break;}},_renderImageToCanvas:function(){if(!e.os.ios){return function(h){var i=e.slice(arguments,1),g=h.getContext('2d');g.drawImage.apply(g,i)}}function detectVerticalSquash(p,q,h){var i=document.createElement('canvas'),n=i.getContext('2d'),k=0,o=h,g=h,m,l,j;i.width=1;i.height=h;n.drawImage(p,0,0);m=n.getImageData(0,0,1,h).data;while(g>k){l=m[(g-1)*4+3];if(l===0){o=g}else {k=g}g=o+k>>1}j=g/h;return j===0?1:j}if(e.os.ios>=7){return function(k,g,n,o,m,l){var j=g.naturalWidth,i=g.naturalHeight,h=detectVerticalSquash(g,j,i);return k.getContext('2d').drawImage(g,0,0,j*h,i*h,n,o,m,l)}}function detectSubsampling(i){var j=i.naturalWidth,k=i.naturalHeight,g,h;if(j*k>1024*1024){g=document.createElement('canvas');g.width=g.height=1;h=g.getContext('2d');h.drawImage(i,-j+1,0);return h.getImageData(0,0,1,1).data[3]===0}else {return !1}}return function(w,i,z,A,y,x){var l=i.naturalWidth,k=i.naturalHeight,n=w.getContext('2d'),u=detectSubsampling(i),v=this.type==='image/jpeg',g=1024,r=0,t=0,h,j,s,p,o,m,q;if(u){l/=2;k/=2}n.save();h=document.createElement('canvas');h.width=h.height=g;j=h.getContext('2d');s=v?detectVerticalSquash(i,l,k):1;p=Math.ceil(g*y/l);o=Math.ceil(g*x/k/s);while(r<k){m=0;q=0;while(m<l){j.clearRect(0,0,g,g);j.drawImage(i,-m,-r);n.drawImage(h,0,0,g,g,z+q,A+t,p,o);m+=g;q+=p}r+=g;t+=o}n.restore();h=j=null}}()})});a('runtime/html5/transport',['base','runtime/html5/runtime'],function(e,g){var d=e.noop,f=e.$;return g.register('Transport',{init:function(){this._status=0;this._response=null},send:function(){var m=this.owner,h=this.options,d=this._initAjax(),n=m._blob,l=h.server,j,k,i;if(h.sendAsBinary){l+=h.attachInfoToQuery!==!1?(/\?/.test(l)?'&':'?')+f.param(m._formData):'';k=n.getSource()}else {j=new FormData();f.each(m._formData,function(d,f){j.append(d,f)});j.append(h.fileVal,n.getSource(),h.filename||m._formData.name||'')}if(h.withCredentials&&'withCredentials' in d){d.open(h.method,l,!0);d.withCredentials=!0}else {d.open(h.method,l)}this._setRequestHeader(d,h.headers);if(k){d.overrideMimeType&&d.overrideMimeType('application/octet-stream');if(e.os.android){i=new FileReader();i.onload=function(){d.send(this.result);i=i.onload=null};i.readAsArrayBuffer(k)}else {d.send(k)}}else {d.send(j)}},getResponse:function(){return this._response},getResponseAsJson:function(){return this._parseJson(this._response)},getResponseHeaders:function(){return this._headers},getStatus:function(){return this._status},abort:function(){var f=this._xhr;if(f){f.upload.onprogress=d;f.onreadystatechange=d;f.abort();this._xhr=f=null}},destroy:function(){this.abort()},_parseHeader:function(d){var f={};d&&d.replace(/^([^:]+):(.*)$/mg,function(j,i,h){f[i.trim()]=h.trim()});return f},_initAjax:function(){var h=this,f=new XMLHttpRequest(),i=this.options;if(i.withCredentials&&!('withCredentials' in f)&&typeof XDomainRequest!=='undefined'){f=new XDomainRequest()}f.upload.onprogress=function(d){var f=0;if(d.lengthComputable){f=d.loaded/d.total}return h.trigger('progress',f)};f.onreadystatechange=function(){if(f.readyState!==4){return}f.upload.onprogress=d;f.onreadystatechange=d;h._xhr=null;h._status=f.status;var i='|',j=i+f.status+i+f.statusText;if(f.status>=200&&f.status<300){h._response=f.responseText;h._headers=h._parseHeader(f.getAllResponseHeaders());return h.trigger('load')}else {if(f.status>=500&&f.status<600){h._response=f.responseText;h._headers=h._parseHeader(f.getAllResponseHeaders());return h.trigger('error','server'+j)}}return h.trigger('error',h._status?'http'+j:'abort')};h._xhr=f;return f},_setRequestHeader:function(h,d){f.each(d,function(f,i){h.setRequestHeader(f,i)})},_parseJson:function(f){var d;try{d=JSON.parse(f)}catch(h){d={}}return d}})});a('runtime/html5/md5',['runtime/html5/runtime'],function(q){var j=function(d,e){return d+e&4.294967295E9},l=function(g,d,f,i,e,h){d=j(j(d,g),j(i,h));return j(d<<e|d>>>32-e,f)},e=function(e,d,f,g,j,h,i){return l(d&f|~d&g,e,d,j,h,i)},f=function(f,d,g,e,j,h,i){return l(d&e|g&~e,f,d,j,h,i)},g=function(e,d,f,g,j,h,i){return l(d^f^g,e,d,j,h,i)},h=function(e,d,f,g,j,h,i){return l(f^(d|~g),e,d,j,h,i)},i=function(n,m){var d=n[0],i=n[1],k=n[2],l=n[3];d=e(d,i,k,l,m[0],7,-680876936);l=e(l,d,i,k,m[1],12,-389564586);k=e(k,l,d,i,m[2],17,606105819);i=e(i,k,l,d,m[3],22,-1044525330);d=e(d,i,k,l,m[4],7,-176418897);l=e(l,d,i,k,m[5],12,1200080426);k=e(k,l,d,i,m[6],17,-1473231341);i=e(i,k,l,d,m[7],22,-45705983);d=e(d,i,k,l,m[8],7,1770035416);l=e(l,d,i,k,m[9],12,-1958414417);k=e(k,l,d,i,m[10],17,-42063);i=e(i,k,l,d,m[11],22,-1990404162);d=e(d,i,k,l,m[12],7,1804603682);l=e(l,d,i,k,m[13],12,-40341101);k=e(k,l,d,i,m[14],17,-1502002290);i=e(i,k,l,d,m[15],22,1236535329);d=f(d,i,k,l,m[1],5,-165796510);l=f(l,d,i,k,m[6],9,-1069501632);k=f(k,l,d,i,m[11],14,643717713);i=f(i,k,l,d,m[0],20,-373897302);d=f(d,i,k,l,m[5],5,-701558691);l=f(l,d,i,k,m[10],9,38016083);k=f(k,l,d,i,m[15],14,-660478335);i=f(i,k,l,d,m[4],20,-405537848);d=f(d,i,k,l,m[9],5,568446438);l=f(l,d,i,k,m[14],9,-1019803690);k=f(k,l,d,i,m[3],14,-187363961);i=f(i,k,l,d,m[8],20,1163531501);d=f(d,i,k,l,m[13],5,-1444681467);l=f(l,d,i,k,m[2],9,-51403784);k=f(k,l,d,i,m[7],14,1735328473);i=f(i,k,l,d,m[12],20,-1926607734);d=g(d,i,k,l,m[5],4,-378558);l=g(l,d,i,k,m[8],11,-2022574463);k=g(k,l,d,i,m[11],16,1839030562);i=g(i,k,l,d,m[14],23,-35309556);d=g(d,i,k,l,m[1],4,-1530992060);l=g(l,d,i,k,m[4],11,1272893353);k=g(k,l,d,i,m[7],16,-155497632);i=g(i,k,l,d,m[10],23,-1094730640);d=g(d,i,k,l,m[13],4,681279174);l=g(l,d,i,k,m[0],11,-358537222);k=g(k,l,d,i,m[3],16,-722521979);i=g(i,k,l,d,m[6],23,76029189);d=g(d,i,k,l,m[9],4,-640364487);l=g(l,d,i,k,m[12],11,-421815835);k=g(k,l,d,i,m[15],16,530742520);i=g(i,k,l,d,m[2],23,-995338651);d=h(d,i,k,l,m[0],6,-198630844);l=h(l,d,i,k,m[7],10,1126891415);k=h(k,l,d,i,m[14],15,-1416354905);i=h(i,k,l,d,m[5],21,-57434055);d=h(d,i,k,l,m[12],6,1700485571);l=h(l,d,i,k,m[3],10,-1894986606);k=h(k,l,d,i,m[10],15,-1051523);i=h(i,k,l,d,m[1],21,-2054922799);d=h(d,i,k,l,m[8],6,1873313359);l=h(l,d,i,k,m[15],10,-30611744);k=h(k,l,d,i,m[6],15,-1560198380);i=h(i,k,l,d,m[13],21,1309151649);d=h(d,i,k,l,m[4],6,-145523070);l=h(l,d,i,k,m[11],10,-1120210379);k=h(k,l,d,i,m[2],15,718787259);i=h(i,k,l,d,m[9],21,-343485551);n[0]=j(d,n[0]);n[1]=j(i,n[1]);n[2]=j(k,n[2]);n[3]=j(l,n[3])},p=function(e){var f=[],d;for(d=0;d<64;d+=4){f[d>>2]=e.charCodeAt(d)+(e.charCodeAt(d+1)<<8)+(e.charCodeAt(d+2)<<16)+(e.charCodeAt(d+3)<<24)}return f},n=function(e){var f=[],d;for(d=0;d<64;d+=4){f[d>>2]=e[d]+(e[d+1]<<8)+(e[d+2]<<16)+(e[d+3]<<24)}return f},m=function(f){var m=f.length,h=[1732584193,-271733879,-1732584194,271733878],d,j,e,g,l,k;for(d=64;d<=m;d+=64){i(h,p(f.substring(d-64,d)))}f=f.substring(d-64);j=f.length;e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(d=0;d<j;d+=1){e[d>>2]|=f.charCodeAt(d)<<(d%4<<3)}e[d>>2]|=128<<(d%4<<3);if(d>55){i(h,e);for(d=0;d<16;d+=1){e[d]=0}}g=m*8;g=g.toString(16).match(/(.*?)(.{0,8})$/);l=parseInt(g[2],16);k=parseInt(g[1],16)||0;e[14]=l;e[15]=k;i(h,e);return h},r=function(f){var j=f.length,h=[1732584193,-271733879,-1732584194,271733878],d,k,e,g,m,l;for(d=64;d<=j;d+=64){i(h,n(f.subarray(d-64,d)))}f=d-64<j?f.subarray(d-64):new Uint8Array(0);k=f.length;e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(d=0;d<k;d+=1){e[d>>2]|=f[d]<<(d%4<<3)}e[d>>2]|=128<<(d%4<<3);if(d>55){i(h,e);for(d=0;d<16;d+=1){e[d]=0}}g=j*8;g=g.toString(16).match(/(.*?)(.{0,8})$/);m=parseInt(g[2],16);l=parseInt(g[1],16)||0;e[14]=m;e[15]=l;i(h,e);return h},o=['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'],s=function(e){var f='',d;for(d=0;d<4;d+=1){f+=o[e>>d*8+4&15]+o[e>>d*8&15]}return f},k=function(e){var d;for(d=0;d<e.length;d+=1){e[d]=s(e[d])}return e.join('')},t=function(d){return k(m(d))},d=function(){this.reset()};if(t('hello')!=='5d41402abc4b2a76b9719d911017c592'){j=function(e,f){var d=(e&65535)+(f&65535),g=(e>>16)+(f>>16)+(d>>16);return g<<16|d&65535}}d.prototype.append=function(d){if(/[\u0080-\uFFFF]/.test(d)){d=unescape(encodeURIComponent(d))}this.appendBinary(d);return this};d.prototype.appendBinary=function(e){this._buff+=e;this._length+=e.length;var f=this._buff.length,d;for(d=64;d<=f;d+=64){i(this._state,p(this._buff.substring(d-64,d)))}this._buff=this._buff.substr(d-64);return this};d.prototype.end=function(i){var f=this._buff,e=f.length,d,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h;for(d=0;d<e;d+=1){g[d>>2]|=f.charCodeAt(d)<<(d%4<<3)}this._finish(g,e);h=!!i?this._state:k(this._state);this.reset();return h};d.prototype._finish=function(e,j){var d=j,f,h,g;e[d>>2]|=128<<(d%4<<3);if(d>55){i(this._state,e);for(d=0;d<16;d+=1){e[d]=0}}f=this._length*8;f=f.toString(16).match(/(.*?)(.{0,8})$/);h=parseInt(f[2],16);g=parseInt(f[1],16)||0;e[14]=h;e[15]=g;i(this._state,e)};d.prototype.reset=function(){this._buff='';this._length=0;this._state=[1732584193,-271733879,-1732584194,271733878];return this};d.prototype.destroy=function(){delete this._state;delete this._buff;delete this._length};d.hash=function(d,f){if(/[\u0080-\uFFFF]/.test(d)){d=unescape(encodeURIComponent(d))}var e=m(d);return !!f?e:k(e)};d.hashBinary=function(e,f){var d=m(e);return !!f?d:k(d)};d.ArrayBuffer=function(){this.reset()};d.ArrayBuffer.prototype.append=function(g){var e=this._concatArrayBuffer(this._buff,g),f=e.length,d;this._length+=g.byteLength;for(d=64;d<=f;d+=64){i(this._state,n(e.subarray(d-64,d)))}this._buff=d-64<f?e.subarray(d-64):new Uint8Array(0);return this};d.ArrayBuffer.prototype.end=function(i){var f=this._buff,e=f.length,g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d,h;for(d=0;d<e;d+=1){g[d>>2]|=f[d]<<(d%4<<3)}this._finish(g,e);h=!!i?this._state:k(this._state);this.reset();return h};d.ArrayBuffer.prototype._finish=d.prototype._finish;d.ArrayBuffer.prototype.reset=function(){this._buff=new Uint8Array(0);this._length=0;this._state=[1732584193,-271733879,-1732584194,271733878];return this};d.ArrayBuffer.prototype.destroy=d.prototype.destroy;d.ArrayBuffer.prototype._concatArrayBuffer=function(g,f){var e=g.length,d=new Uint8Array(e+f.byteLength);d.set(g);d.set(new Uint8Array(f),e);return d};d.ArrayBuffer.hash=function(e,f){var d=r(new Uint8Array(e));return !!f?d:k(d)};return q.register('Md5',{init:function(){},loadFromBlob:function(k){var e=k.getSource(),h=2*1024*1024,n=Math.ceil(e.size/h),l=0,i=this.owner,j=new d.ArrayBuffer(),o=this,m=e.mozSlice||e.webkitSlice||e.slice,g,f;f=new FileReader();g=function(){var d,p;d=l*h;p=Math.min(d+h,e.size);f.onload=function(d){j.append(d.target.result);i.trigger('progress',{total:k.size,loaded:p})};f.onloadend=function(){f.onloadend=f.onload=null;if(++l<n){setTimeout(g,1)}else {setTimeout(function(){i.trigger('load');o.result=j.end();g=k=e=j=null;i.trigger('complete')},50)}};f.readAsArrayBuffer(m.call(e,d,p))};g()},getResult:function(){return this.result}})});a('runtime/flash/runtime',['base','runtime/runtime','runtime/compbase'],function(d,f,i){var h=d.$,g='flash',e={};function getFlashVersion(){var e;try{e=navigator.plugins['Shockwave Flash'];e=e.description}catch(j){try{e=(new ActiveXObject('ShockwaveFlash.ShockwaveFlash')).GetVariable('$version')}catch(k){e='0.0'}}e=e.match(/\d+/g);return parseFloat(e[0]+'.'+e[1],10)}function FlashRuntime(){var k={},j={},m=this.destroy,h=this,l=d.guid('webuploader_');f.apply(h,arguments);h.type=g;h.exec=function(n,o){var l=this,m=l.uid,p=d.slice(arguments,2),g;j[m]=l;if(e[n]){if(!k[m]){k[m]=new e[n](l,h)}g=k[m];if(g[o]){return g[o].apply(g,p)}}return h.flashExec.apply(l,arguments)};function handler(l,m){var e=l.type||l,k,g;k=e.split('::');g=k[0];e=k[1];if(e==='Ready'&&g===h.uid){h.trigger('ready')}else {if(j[g]){j[g].trigger(e.toLowerCase(),l,m)}}}b[l]=function(){var e=arguments;setTimeout(function(){handler.apply(null,e)},1)};this.jsreciver=l;this.destroy=function(){return m&&m.apply(this,arguments)};this.flashExec=function(j,k){var e=h.getFlash(),g=d.slice(arguments,2);return e.exec(this.uid,j,k,g)}}d.inherits(f,{constructor:FlashRuntime,init:function(){var g=this.getContainer(),h=this.options,e;g.css({position:'absolute',top:'-8px',left:'-8px',width:'9px',height:'9px',overflow:'hidden'});e='<object id="'+this.uid+'" type="application/'+'x-shockwave-flash" data="'+h.swf+'" ';if(d.browser.ie){e+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '}e+='width="100%" height="100%" style="outline:0">'+'<param name="movie" value="'+h.swf+'" />'+'<param name="flashvars" value="uid='+this.uid+'&jsreciver='+this.jsreciver+'" />'+'<param name="wmode" value="transparent" />'+'<param name="allowscriptaccess" value="always" />'+'</object>';g.html(e)},getFlash:function(){if(this._flash){return this._flash}this._flash=h('#'+this.uid).get(0);return this._flash}});FlashRuntime.register=function(j,g){g=e[j]=d.inherits(i,h.extend({flashExec:function(){var h=this.owner,e=this.getRuntime();return e.flashExec.apply(h,arguments)}},g));return g};if(getFlashVersion()>=11.4){f.addRuntime(g,FlashRuntime)}return FlashRuntime});a('runtime/flash/filepicker',['base','runtime/flash/runtime'],function(e,d){var f=e.$;return d.register('FilePicker',{init:function(j){var g=f.extend({},j),i,h;i=g.accept&&g.accept.length;for(h=0;h<i;h++){if(!g.accept[h].title){g.accept[h].title='Files'}}delete g.button;delete g.id;delete g.container;this.flashExec('FilePicker','init',g)},destroy:function(){this.flashExec('FilePicker','destroy')}})});a('runtime/flash/image',['runtime/flash/runtime'],function(d){return d.register('Image',{loadFromBlob:function(f){var e=this.owner;e.info()&&this.flashExec('Image','info',e.info());e.meta()&&this.flashExec('Image','meta',e.meta());this.flashExec('Image','loadFromBlob',f.uid)}})});a('runtime/flash/transport',['base','runtime/flash/runtime','runtime/client'],function(g,f,e){var d=g.$;return f.register('Transport',{init:function(){this._status=0;this._response=null;this._responseJson=null},send:function(){var j=this.owner,h=this.options,i=this._initAjax(),l=j._blob,k=h.server,m;i.connectRuntime(l.ruid);if(h.sendAsBinary){k+=(/\?/.test(k)?'&':'?')+d.param(j._formData);m=l.uid}else {d.each(j._formData,function(d,h){i.exec('append',d,h)});i.exec('appendBlob',h.fileVal,l.uid,h.filename||j._formData.name||'')}this._setRequestHeader(i,h.headers);i.exec('send',{method:h.method,url:k,forceURLStream:h.forceURLStream,mimeType:'application/octet-stream'},m)},getStatus:function(){return this._status},getResponse:function(){return this._response||''},getResponseAsJson:function(){return this._responseJson},getResponseHeaders:function(){return {}},abort:function(){var d=this._xhr;if(d){d.exec('abort');d.destroy();this._xhr=d=null}},destroy:function(){this.abort()},_initAjax:function(){var d=this,h=new e('XMLHttpRequest');h.on('uploadprogress progress',function(i){var h=i.loaded/i.total;h=Math.min(1,Math.max(0,h));return d.trigger('progress',h)});h.on('load',function(){var i=h.exec('getStatus'),k=!1,j='',l;h.off();d._xhr=null;if(i>=200&&i<300){k=!0}else {if(i>=500&&i<600){k=!0;j='server-'+i}else {j='http-'+i}}if(k){d._response=h.exec('getResponse');d._response=decodeURIComponent(d._response);l=function(d){try{if(b.JSON&&b.JSON.parse){return JSON.parse(d)}return (new Function('return '+d)).call()}catch(m){return {}}};d._responseJson=d._response?l(d._response):{}}h.destroy();h=null;return j?d.trigger('error',j):d.trigger('load')});h.on('error',function(){var i=h.exec('getStatus'),j=i?'http-'+i:'http';h.off();d._xhr=null;d.trigger('error',j)});d._xhr=h;return h},_setRequestHeader:function(i,h){d.each(h,function(d,j){i.exec('setRequestHeader',d,j)})}})});a('runtime/flash/blob',['runtime/flash/runtime','lib/blob'],function(d,e){return d.register('Blob',{slice:function(f,h){var g=this.flashExec('Blob','slice',f,h);return new e(this.getRuid(),g)}})});a('runtime/flash/md5',['runtime/flash/runtime'],function(d){return d.register('Md5',{init:function(){},loadFromBlob:function(e){return this.flashExec('Md5','loadFromBlob',e.uid)}})});a('preset/all',['base','widgets/filednd','widgets/filepaste','widgets/filepicker','widgets/image','widgets/queue','widgets/runtime','widgets/upload','widgets/validator','widgets/md5','runtime/html5/blob','runtime/html5/dnd','runtime/html5/filepaste','runtime/html5/filepicker','runtime/html5/imagemeta/exif','runtime/html5/androidpatch','runtime/html5/image','runtime/html5/transport','runtime/html5/md5','runtime/flash/filepicker','runtime/flash/image','runtime/flash/transport','runtime/flash/blob','runtime/flash/md5'],function(d){return d});a('widgets/log',['base','uploader','widgets/widget'],function(j,g){var f=j.$,i=' http://static.tieba.baidu.com/tb/pms/img/st.gif??',d=(location.hostname||location.host||'protected').toLowerCase(),h=d&&/baidu/i.exec(d),e;if(!h){return}e={dv:3,master:'webuploader',online:/test/.exec(d)?0:1,module:'',product:d,type:0};function send(h){var k=f.extend({},e,h),l=i.replace(/^(.*)\?/,'$1'+f.param(k)),d=new Image();d.src=l}return g.register({name:'log',init:function(){var f=this.owner,d=0,e=0;f.on('error',function(d){send({type:2,c_error_code:d})}).on('uploadError',function(e,d){send({type:2,c_error_code:'UPLOAD_ERROR',c_reason:''+d})}).on('uploadComplete',function(f){d++;e+=f.size}).on('uploadFinished',function(){send({c_count:d,c_size:e});d=e=0});send({c_usage:1})}})});a('webuploader',['preset/all','widgets/log'],function(d){return d});return c('webuploader')});